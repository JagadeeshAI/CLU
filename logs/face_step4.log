=== Configurations ===
Config: TaskName set to 'Face_recognition'
🚀 Enhanced GS-LoRA CLU Training - Step 4
============================================================
🔧 Configuration:
   Device: cuda
   LoRA Rank: 16 (Enhanced)
   Base Learning Rate: 0.001
   Training Phases: 30 + 60 + 30 = 120 epochs
   Loss Weights: Retain=2.0, New=2.0, Forget=0.15
   Sparsity Settings: Warmup=10, Alpha_K=0.003
   Learning Rate Multipliers: LoRA=2.0x, Retain=0.5x, New=1.5x
   Step Description: Fourth step: Retain 40-79, Forget 30-39, Learn 80-89
============================================================

================================================================================
ENHANCED GS-LoRA STEP 4
Retain Classes: 40-79 (40 classes)
Forget Classes: 30-39 (10 classes)
New Classes:    80-89 (10 classes)
LoRA Rank: 16, Epochs: 120
================================================================================
🛠️ Explicitly received params: {'GPU_ID': [0], 'num_class': 100, 'lora_rank': 16}
🔒 LoRA mode (rank=16): Freezing backbone, unfreezing LoRA + classifier
Loaded pretrained weights from timm: deit_tiny_patch16_224
✅ Loaded pretrained weights
✅ Built face model

📊 Parameter Summary:
  🔢 Total Parameters     : 5.79M
  ✅ Trainable Parameters : 0.39M
  📉 % Trainable          : 6.69%
✓ Loaded model from: checkpoints/steps/30_79.pth
  Compatible parameters: 187/187
✓ Found 12 LoRA groups for enhanced sparse regularization
✓ Data loaders created:
  Retain: 68 batches
  Forget: 107 batches
  New:    110 batches
✓ Enhanced optimizer created with 2 parameter groups

🚀 Starting Enhanced Training for 120 epochs
Phase Schedule: Retention(30) -> Balanced(60) -> Fine-tuning(30)
Epoch 001/120 [Retention ] | Retain 52.91%(28.0) | Forget 0.00%(18.9) | New 0.11%(21.7) | Combined 42.55% | Balanced 26.51% | H-Mean 69.21 | Efficiency 26.51 | Zero 0.000 | LR 1.50e-03 | α 0.0000
  ✓ Saved new best model: Combined Acc 42.55%
    Path: checkpoints/steps/best_step4_epoch1.pth
Epoch 002/120 [Retention ] | Retain 57.24%(29.1) | Forget 0.00%(20.8) | New 1.12%(22.6) | Combined 46.22% | Balanced 29.18% | H-Mean 72.80 | Efficiency 29.18 | Zero 0.000 | LR 1.50e-03 | α 0.0000
  ✓ Saved new best model: Combined Acc 46.22%
    Path: checkpoints/steps/best_step4_epoch2.pth
Epoch 003/120 [Retention ] | Retain 58.39%(28.4) | Forget 0.00%(20.5) | New 2.13%(22.8) | Combined 47.34% | Balanced 30.26% | H-Mean 73.73 | Efficiency 30.26 | Zero 0.000 | LR 1.50e-03 | α 0.0000
  ✓ Saved new best model: Combined Acc 47.34%
    Path: checkpoints/steps/best_step4_epoch3.pth
Epoch 004/120 [Retention ] | Retain 59.45%(31.1) | Forget 0.00%(21.8) | New 0.90%(24.3) | Combined 47.96% | Balanced 30.17% | H-Mean 74.57 | Efficiency 30.17 | Zero 0.000 | LR 1.50e-03 | α 0.0000
  ✓ Saved new best model: Combined Acc 47.96%
    Path: checkpoints/steps/best_step4_epoch4.pth
Epoch 005/120 [Retention ] | Retain 60.41%(29.1) | Forget 0.00%(21.4) | New 0.56%(22.5) | Combined 48.66% | Balanced 30.49% | H-Mean 75.32 | Efficiency 30.49 | Zero 0.000 | LR 1.50e-03 | α 0.0000
  ✓ Saved new best model: Combined Acc 48.66%
    Path: checkpoints/steps/best_step4_epoch5.pth
Epoch 006/120 [Retention ] | Retain 61.45%(30.9) | Forget 0.00%(22.8) | New 2.24%(23.8) | Combined 49.82% | Balanced 31.84% | H-Mean 76.12 | Efficiency 31.84 | Zero 0.000 | LR 1.50e-03 | α 0.0000
  ✓ Saved new best model: Combined Acc 49.82%
    Path: checkpoints/steps/best_step4_epoch6.pth
Epoch 007/120 [Retention ] | Retain 60.33%(31.3) | Forget 0.00%(22.5) | New 2.35%(23.9) | Combined 48.94% | Balanced 31.34% | H-Mean 75.26 | Efficiency 31.34 | Zero 0.000 | LR 1.50e-03 | α 0.0000
Epoch 008/120 [Retention ] | Retain 60.60%(30.4) | Forget 0.00%(24.0) | New 5.60%(23.0) | Combined 49.80% | Balanced 33.10% | H-Mean 75.47 | Efficiency 33.10 | Zero 0.000 | LR 1.50e-03 | α 0.0000
Epoch 009/120 [Retention ] | Retain 60.71%(29.6) | Forget 0.00%(21.3) | New 2.46%(22.9) | Combined 49.27% | Balanced 31.59% | H-Mean 75.55 | Efficiency 31.59 | Zero 0.000 | LR 1.50e-03 | α 0.0000
Epoch 010/120 [Retention ] | Retain 61.40%(28.9) | Forget 0.00%(19.8) | New 7.73%(22.0) | Combined 50.86% | Balanced 34.56% | H-Mean 76.08 | Efficiency 34.56 | Zero 0.000 | LR 1.50e-03 | α 0.0000
  ✓ Saved new best model: Combined Acc 50.86%
    Path: checkpoints/steps/best_step4_epoch10.pth
Epoch 011/120 [Retention ] | Retain 59.62%(29.9) | Forget 0.00%(23.0) | New 5.60%(22.6) | Combined 49.01% | Balanced 32.61% | H-Mean 74.70 | Efficiency 32.61 | Zero 0.000 | LR 1.50e-03 | α 0.0001
Epoch 012/120 [Retention ] | Retain 61.15%(30.4) | Forget 0.00%(21.3) | New 7.28%(22.1) | Combined 50.57% | Balanced 34.21% | H-Mean 75.89 | Efficiency 34.21 | Zero 0.000 | LR 1.50e-03 | α 0.0002
Epoch 013/120 [Retention ] | Retain 61.81%(30.8) | Forget 0.00%(22.2) | New 8.62%(22.4) | Combined 51.36% | Balanced 35.21% | H-Mean 76.39 | Efficiency 35.21 | Zero 0.000 | LR 1.50e-03 | α 0.0002
  ✓ Saved new best model: Combined Acc 51.36%
    Path: checkpoints/steps/best_step4_epoch13.pth
Epoch 014/120 [Retention ] | Retain 62.08%(29.5) | Forget 0.00%(20.2) | New 7.28%(21.4) | Combined 51.32% | Balanced 34.68% | H-Mean 76.60 | Efficiency 34.68 | Zero 0.000 | LR 1.50e-03 | α 0.0003
Epoch 015/120 [Retention ] | Retain 63.01%(30.8) | Forget 0.00%(22.6) | New 11.09%(21.9) | Combined 52.81% | Balanced 37.05% | H-Mean 77.31 | Efficiency 37.05 | Zero 0.000 | LR 1.50e-03 | α 0.0004
  ✓ Saved new best model: Combined Acc 52.81%
    Path: checkpoints/steps/best_step4_epoch15.pth
Epoch 016/120 [Retention ] | Retain 60.05%(30.5) | Forget 0.00%(21.9) | New 13.66%(21.6) | Combined 50.95% | Balanced 36.86% | H-Mean 75.04 | Efficiency 36.86 | Zero 0.000 | LR 1.50e-03 | α 0.0005
Epoch 017/120 [Retention ] | Retain 61.23%(29.7) | Forget 0.00%(21.4) | New 12.21%(20.3) | Combined 51.61% | Balanced 36.72% | H-Mean 75.95 | Efficiency 36.72 | Zero 0.000 | LR 1.50e-03 | α 0.0005
Epoch 018/120 [Retention ] | Retain 60.30%(30.0) | Forget 0.00%(22.7) | New 16.24%(20.5) | Combined 51.65% | Balanced 38.27% | H-Mean 75.23 | Efficiency 38.27 | Zero 0.000 | LR 1.50e-03 | α 0.0006
Epoch 019/120 [Retention ] | Retain 59.95%(29.3) | Forget 0.00%(21.2) | New 13.66%(19.7) | Combined 50.86% | Balanced 36.80% | H-Mean 74.96 | Efficiency 36.80 | Zero 0.000 | LR 1.50e-03 | α 0.0007
Epoch 020/120 [Retention ] | Retain 60.52%(29.8) | Forget 0.00%(21.6) | New 18.81%(19.4) | Combined 52.33% | Balanced 39.67% | H-Mean 75.40 | Efficiency 39.67 | Zero 0.000 | LR 1.50e-03 | α 0.0007
Epoch 021/120 [Retention ] | Retain 61.12%(30.1) | Forget 0.00%(22.3) | New 20.60%(18.4) | Combined 53.17% | Balanced 40.86% | H-Mean 75.87 | Efficiency 40.86 | Zero 0.000 | LR 1.50e-03 | α 0.0008
Epoch 022/120 [Retention ] | Retain 61.40%(30.2) | Forget 0.00%(20.2) | New 20.60%(18.8) | Combined 53.39% | Balanced 41.00% | H-Mean 76.08 | Efficiency 41.00 | Zero 0.000 | LR 1.50e-03 | α 0.0008
  ✓ Saved new best model: Combined Acc 53.39%
    Path: checkpoints/steps/best_step4_epoch22.pth
Epoch 023/120 [Retention ] | Retain 60.79%(29.1) | Forget 0.00%(19.8) | New 20.83%(18.4) | Combined 52.95% | Balanced 40.81% | H-Mean 75.62 | Efficiency 40.81 | Zero 0.000 | LR 1.50e-03 | α 0.0009
Epoch 024/120 [Retention ] | Retain 60.33%(29.0) | Forget 0.00%(20.0) | New 21.28%(18.7) | Combined 52.66% | Balanced 40.80% | H-Mean 75.26 | Efficiency 40.80 | Zero 0.000 | LR 1.50e-03 | α 0.0010
Epoch 025/120 [Retention ] | Retain 61.42%(28.5) | Forget 0.00%(21.8) | New 26.09%(17.3) | Combined 54.49% | Balanced 43.76% | H-Mean 76.10 | Efficiency 43.76 | Zero 0.000 | LR 1.50e-03 | α 0.0010
  ✓ Saved new best model: Combined Acc 54.49%
    Path: checkpoints/steps/best_step4_epoch25.pth
Epoch 026/120 [Retention ] | Retain 60.85%(28.7) | Forget 0.00%(19.8) | New 26.99%(16.8) | Combined 54.20% | Balanced 43.92% | H-Mean 75.66 | Efficiency 43.92 | Zero 0.000 | LR 1.50e-03 | α 0.0011
Epoch 027/120 [Retention ] | Retain 60.79%(29.1) | Forget 0.00%(21.0) | New 23.96%(16.4) | Combined 53.56% | Balanced 42.38% | H-Mean 75.62 | Efficiency 42.38 | Zero 0.000 | LR 1.50e-03 | α 0.0011
Epoch 028/120 [Retention ] | Retain 59.75%(28.2) | Forget 0.00%(19.8) | New 31.47%(15.5) | Combined 54.20% | Balanced 45.61% | H-Mean 74.81 | Efficiency 45.61 | Zero 0.000 | LR 1.50e-03 | α 0.0012
Epoch 029/120 [Retention ] | Retain 61.15%(29.1) | Forget 0.00%(19.2) | New 26.43%(16.9) | Combined 54.33% | Balanced 43.79% | H-Mean 75.89 | Efficiency 43.79 | Zero 0.000 | LR 1.50e-03 | α 0.0012
Epoch 030/120 [Retention ] | Retain 59.45%(28.1) | Forget 0.00%(18.7) | New 27.88%(14.3) | Combined 53.25% | Balanced 43.67% | H-Mean 74.57 | Efficiency 43.67 | Zero 0.000 | LR 1.50e-03 | α 0.0013

🔄 Transitioning to Balanced Phase (emphasis on both retain and new)
Epoch 031/120 [Balanced  ] | Retain 61.09%(28.5) | Forget 0.00%(19.1) | New 28.78%(14.7) | Combined 54.75% | Balanced 44.94% | H-Mean 75.85 | Efficiency 44.94 | Zero 0.000 | LR 1.49e-03 | α 0.0013
Epoch 032/120 [Balanced  ] | Retain 59.70%(28.6) | Forget 0.00%(19.8) | New 32.81%(15.0) | Combined 54.42% | Balanced 46.25% | H-Mean 74.76 | Efficiency 46.25 | Zero 0.000 | LR 1.48e-03 | α 0.0014
Epoch 033/120 [Balanced  ] | Retain 60.36%(27.8) | Forget 0.00%(18.7) | New 31.13%(14.0) | Combined 54.62% | Balanced 45.74% | H-Mean 75.28 | Efficiency 45.74 | Zero 0.000 | LR 1.48e-03 | α 0.0014
Epoch 034/120 [Balanced  ] | Retain 58.85%(26.8) | Forget 0.00%(17.2) | New 32.92%(13.9) | Combined 53.76% | Balanced 45.89% | H-Mean 74.10 | Efficiency 45.89 | Zero 0.000 | LR 1.47e-03 | α 0.0014
Epoch 035/120 [Balanced  ] | Retain 59.62%(27.6) | Forget 0.00%(17.2) | New 36.95%(13.3) | Combined 55.17% | Balanced 48.29% | H-Mean 74.70 | Efficiency 48.29 | Zero 0.000 | LR 1.46e-03 | α 0.0015
  ✓ Saved new best model: Combined Acc 55.17%
    Path: checkpoints/steps/best_step4_epoch35.pth
Epoch 036/120 [Balanced  ] | Retain 59.34%(27.1) | Forget 0.00%(17.9) | New 38.75%(13.4) | Combined 55.30% | Balanced 49.04% | H-Mean 74.48 | Efficiency 49.04 | Zero 0.000 | LR 1.45e-03 | α 0.0015
Epoch 037/120 [Balanced  ] | Retain 59.40%(27.2) | Forget 0.00%(17.5) | New 37.29%(12.7) | Combined 55.06% | Balanced 48.34% | H-Mean 74.53 | Efficiency 48.34 | Zero 0.000 | LR 1.45e-03 | α 0.0016
Epoch 038/120 [Balanced  ] | Retain 59.43%(26.7) | Forget 0.00%(17.2) | New 40.87%(12.0) | Combined 55.78% | Balanced 50.15% | H-Mean 74.55 | Efficiency 50.15 | Zero 0.000 | LR 1.44e-03 | α 0.0016
  ✓ Saved new best model: Combined Acc 55.78%
    Path: checkpoints/steps/best_step4_epoch38.pth
Epoch 039/120 [Balanced  ] | Retain 59.92%(26.7) | Forget 0.00%(17.6) | New 42.78%(12.7) | Combined 56.55% | Balanced 51.35% | H-Mean 74.94 | Efficiency 51.35 | Zero 0.000 | LR 1.43e-03 | α 0.0016
  ✓ Saved new best model: Combined Acc 56.55%
    Path: checkpoints/steps/best_step4_epoch39.pth
Epoch 040/120 [Balanced  ] | Retain 59.40%(26.0) | Forget 0.00%(18.3) | New 45.35%(11.8) | Combined 56.64% | Balanced 52.38% | H-Mean 74.53 | Efficiency 52.38 | Zero 0.000 | LR 1.43e-03 | α 0.0017
Epoch 041/120 [Balanced  ] | Retain 59.56%(27.0) | Forget 0.00%(17.7) | New 43.45%(12.5) | Combined 56.40% | Balanced 51.51% | H-Mean 74.66 | Efficiency 51.51 | Zero 0.000 | LR 1.42e-03 | α 0.0017
Epoch 042/120 [Balanced  ] | Retain 58.36%(25.8) | Forget 0.00%(17.1) | New 44.90%(11.8) | Combined 55.72% | Balanced 51.63% | H-Mean 73.70 | Efficiency 51.63 | Zero 0.000 | LR 1.41e-03 | α 0.0017
Epoch 043/120 [Balanced  ] | Retain 58.06%(25.5) | Forget 0.00%(17.1) | New 46.92%(11.1) | Combined 55.87% | Balanced 52.49% | H-Mean 73.46 | Efficiency 52.49 | Zero 0.000 | LR 1.40e-03 | α 0.0018
Epoch 044/120 [Balanced  ] | Retain 58.69%(26.0) | Forget 0.00%(17.4) | New 47.03%(12.1) | Combined 56.40% | Balanced 52.86% | H-Mean 73.97 | Efficiency 52.86 | Zero 0.000 | LR 1.39e-03 | α 0.0018
Epoch 045/120 [Balanced  ] | Retain 58.47%(26.1) | Forget 0.00%(17.6) | New 47.14%(11.6) | Combined 56.24% | Balanced 52.81% | H-Mean 73.79 | Efficiency 52.81 | Zero 0.000 | LR 1.39e-03 | α 0.0018
Epoch 046/120 [Balanced  ] | Retain 57.29%(25.3) | Forget 0.00%(18.0) | New 50.39%(11.2) | Combined 55.94% | Balanced 53.84% | H-Mean 72.85 | Efficiency 53.84 | Zero 0.000 | LR 1.38e-03 | α 0.0019
Epoch 047/120 [Balanced  ] | Retain 58.91%(25.0) | Forget 0.00%(17.3) | New 50.95%(10.6) | Combined 57.34% | Balanced 54.93% | H-Mean 74.14 | Efficiency 54.93 | Zero 0.000 | LR 1.37e-03 | α 0.0019
  ✓ Saved new best model: Combined Acc 57.34%
    Path: checkpoints/steps/best_step4_epoch47.pth
Epoch 048/120 [Balanced  ] | Retain 57.56%(25.5) | Forget 0.00%(17.3) | New 49.38%(11.0) | Combined 55.96% | Balanced 53.47% | H-Mean 73.07 | Efficiency 53.47 | Zero 0.000 | LR 1.36e-03 | α 0.0019
Epoch 049/120 [Balanced  ] | Retain 57.67%(25.2) | Forget 0.00%(17.5) | New 52.74%(10.9) | Combined 56.71% | Balanced 55.21% | H-Mean 73.16 | Efficiency 55.21 | Zero 0.000 | LR 1.36e-03 | α 0.0020
Epoch 050/120 [Balanced  ] | Retain 57.70%(25.9) | Forget 0.00%(18.0) | New 50.06%(12.0) | Combined 56.20% | Balanced 53.88% | H-Mean 73.18 | Efficiency 53.88 | Zero 0.000 | LR 1.35e-03 | α 0.0020
Epoch 051/120 [Balanced  ] | Retain 56.39%(25.4) | Forget 0.00%(17.9) | New 50.73%(11.9) | Combined 55.28% | Balanced 53.56% | H-Mean 72.11 | Efficiency 53.56 | Zero 0.000 | LR 1.34e-03 | α 0.0020
Epoch 052/120 [Balanced  ] | Retain 56.99%(24.5) | Forget 0.00%(17.2) | New 54.09%(11.3) | Combined 56.42% | Balanced 55.54% | H-Mean 72.60 | Efficiency 55.54 | Zero 0.000 | LR 1.34e-03 | α 0.0020
Epoch 053/120 [Balanced  ] | Retain 58.14%(24.9) | Forget 0.00%(16.7) | New 52.63%(10.6) | Combined 57.06% | Balanced 55.39% | H-Mean 73.53 | Efficiency 55.39 | Zero 0.000 | LR 1.33e-03 | α 0.0021
Epoch 054/120 [Balanced  ] | Retain 57.92%(24.7) | Forget 0.00%(18.4) | New 52.30%(11.2) | Combined 56.82% | Balanced 55.11% | H-Mean 73.35 | Efficiency 55.11 | Zero 0.000 | LR 1.32e-03 | α 0.0021
Epoch 055/120 [Balanced  ] | Retain 58.44%(25.0) | Forget 0.00%(16.8) | New 53.42%(11.0) | Combined 57.45% | Balanced 55.93% | H-Mean 73.77 | Efficiency 55.93 | Zero 0.000 | LR 1.31e-03 | α 0.0021
Epoch 056/120 [Balanced  ] | Retain 58.55%(24.7) | Forget 0.00%(16.6) | New 56.77%(10.8) | Combined 58.20% | Balanced 57.66% | H-Mean 73.86 | Efficiency 57.66 | Zero 0.000 | LR 1.30e-03 | α 0.0021
  ✓ Saved new best model: Combined Acc 58.20%
    Path: checkpoints/steps/best_step4_epoch56.pth
Epoch 057/120 [Balanced  ] | Retain 58.25%(24.8) | Forget 0.00%(16.3) | New 56.10%(10.7) | Combined 57.83% | Balanced 57.18% | H-Mean 73.62 | Efficiency 57.18 | Zero 0.000 | LR 1.30e-03 | α 0.0022
Epoch 058/120 [Balanced  ] | Retain 55.81%(24.4) | Forget 0.00%(16.1) | New 56.66%(11.2) | Combined 55.98% | Balanced 56.24% | H-Mean 71.64 | Efficiency 56.24 | Zero 0.000 | LR 1.29e-03 | α 0.0022
Epoch 059/120 [Balanced  ] | Retain 58.19%(26.5) | Forget 0.00%(18.5) | New 56.77%(11.8) | Combined 57.92% | Balanced 57.48% | H-Mean 73.57 | Efficiency 57.48 | Zero 0.000 | LR 1.28e-03 | α 0.0022
Epoch 060/120 [Balanced  ] | Retain 57.48%(25.4) | Forget 0.00%(17.3) | New 59.46%(11.3) | Combined 57.87% | Balanced 58.47% | H-Mean 73.00 | Efficiency 58.47 | Zero 0.000 | LR 1.27e-03 | α 0.0022
Epoch 061/120 [Balanced  ] | Retain 56.20%(25.0) | Forget 0.00%(18.2) | New 62.26%(11.4) | Combined 57.39% | Balanced 59.23% | H-Mean 71.96 | Efficiency 59.23 | Zero 0.000 | LR 1.27e-03 | α 0.0023
Epoch 062/120 [Balanced  ] | Retain 54.42%(23.2) | Forget 0.00%(14.6) | New 62.04%(9.5) | Combined 55.91% | Balanced 58.23% | H-Mean 70.48 | Efficiency 58.23 | Zero 0.000 | LR 1.26e-03 | α 0.0023
Epoch 063/120 [Balanced  ] | Retain 56.36%(23.9) | Forget 0.00%(16.0) | New 61.37%(9.8) | Combined 57.34% | Balanced 58.86% | H-Mean 72.09 | Efficiency 58.86 | Zero 0.000 | LR 1.25e-03 | α 0.0023
Epoch 064/120 [Balanced  ] | Retain 56.14%(23.9) | Forget 0.00%(15.5) | New 62.26%(10.4) | Combined 57.34% | Balanced 59.20% | H-Mean 71.91 | Efficiency 59.20 | Zero 0.000 | LR 1.25e-03 | α 0.0023
Epoch 065/120 [Balanced  ] | Retain 57.18%(24.4) | Forget 0.00%(17.6) | New 60.81%(10.9) | Combined 57.89% | Balanced 58.99% | H-Mean 72.76 | Efficiency 58.99 | Zero 0.000 | LR 1.24e-03 | α 0.0023
Epoch 066/120 [Balanced  ] | Retain 55.62%(24.1) | Forget 0.00%(18.7) | New 60.36%(10.8) | Combined 56.55% | Balanced 57.99% | H-Mean 71.48 | Efficiency 57.99 | Zero 0.000 | LR 1.23e-03 | α 0.0023
Epoch 067/120 [Balanced  ] | Retain 56.69%(24.3) | Forget 0.00%(16.5) | New 60.36%(11.5) | Combined 57.41% | Balanced 58.52% | H-Mean 72.36 | Efficiency 58.52 | Zero 0.000 | LR 1.22e-03 | α 0.0024
Epoch 068/120 [Balanced  ] | Retain 55.84%(25.1) | Forget 0.00%(18.8) | New 59.91%(12.2) | Combined 56.64% | Balanced 57.88% | H-Mean 71.66 | Efficiency 57.88 | Zero 0.000 | LR 1.22e-03 | α 0.0024
Epoch 069/120 [Balanced  ] | Retain 54.61%(24.1) | Forget 0.00%(17.6) | New 61.59%(11.8) | Combined 55.98% | Balanced 58.10% | H-Mean 70.64 | Efficiency 58.10 | Zero 0.000 | LR 1.21e-03 | α 0.0024
Epoch 070/120 [Balanced  ] | Retain 55.92%(24.9) | Forget 0.00%(17.8) | New 63.49%(11.3) | Combined 57.41% | Balanced 59.71% | H-Mean 71.73 | Efficiency 59.71 | Zero 0.000 | LR 1.20e-03 | α 0.0024
Epoch 071/120 [Balanced  ] | Retain 54.69%(23.0) | Forget 0.00%(15.1) | New 62.60%(10.9) | Combined 56.24% | Balanced 58.65% | H-Mean 70.71 | Efficiency 58.65 | Zero 0.000 | LR 1.19e-03 | α 0.0024
Epoch 072/120 [Balanced  ] | Retain 56.03%(24.0) | Forget 0.00%(16.4) | New 65.06%(11.4) | Combined 57.81% | Balanced 60.55% | H-Mean 71.82 | Efficiency 60.55 | Zero 0.000 | LR 1.19e-03 | α 0.0024
Epoch 073/120 [Balanced  ] | Retain 55.10%(23.3) | Forget 0.00%(17.5) | New 64.95%(10.8) | Combined 57.04% | Balanced 60.03% | H-Mean 71.05 | Efficiency 60.03 | Zero 0.000 | LR 1.18e-03 | α 0.0025
Epoch 074/120 [Balanced  ] | Retain 55.84%(23.5) | Forget 0.00%(18.3) | New 65.40%(10.5) | Combined 57.72% | Balanced 60.62% | H-Mean 71.66 | Efficiency 60.62 | Zero 0.000 | LR 1.17e-03 | α 0.0025
Epoch 075/120 [Balanced  ] | Retain 55.70%(23.7) | Forget 0.00%(17.4) | New 62.82%(12.2) | Combined 57.10% | Balanced 59.26% | H-Mean 71.55 | Efficiency 59.26 | Zero 0.000 | LR 1.16e-03 | α 0.0025
Epoch 076/120 [Balanced  ] | Retain 56.58%(24.0) | Forget 0.00%(18.1) | New 64.17%(11.6) | Combined 58.07% | Balanced 60.37% | H-Mean 72.27 | Efficiency 60.37 | Zero 0.000 | LR 1.16e-03 | α 0.0025
Epoch 077/120 [Balanced  ] | Retain 54.56%(23.1) | Forget 0.00%(17.2) | New 65.62%(11.1) | Combined 56.73% | Balanced 60.09% | H-Mean 70.60 | Efficiency 60.09 | Zero 0.000 | LR 1.15e-03 | α 0.0025
Epoch 078/120 [Balanced  ] | Retain 52.91%(22.6) | Forget 0.00%(16.8) | New 65.51%(11.3) | Combined 55.39% | Balanced 59.21% | H-Mean 69.21 | Efficiency 59.21 | Zero 0.000 | LR 1.14e-03 | α 0.0025
Epoch 079/120 [Balanced  ] | Retain 54.75%(23.6) | Forget 0.00%(17.8) | New 64.17%(11.4) | Combined 56.60% | Balanced 59.46% | H-Mean 70.76 | Efficiency 59.46 | Zero 0.000 | LR 1.13e-03 | α 0.0025
Epoch 080/120 [Balanced  ] | Retain 54.15%(23.8) | Forget 0.00%(18.8) | New 63.05%(12.3) | Combined 55.89% | Balanced 58.60% | H-Mean 70.25 | Efficiency 58.60 | Zero 0.000 | LR 1.13e-03 | α 0.0026
Epoch 081/120 [Balanced  ] | Retain 56.31%(24.7) | Forget 0.00%(18.0) | New 65.51%(12.8) | Combined 58.11% | Balanced 60.91% | H-Mean 72.05 | Efficiency 60.91 | Zero 0.000 | LR 1.12e-03 | α 0.0026
Epoch 082/120 [Balanced  ] | Retain 55.24%(23.8) | Forget 0.00%(18.1) | New 65.29%(12.8) | Combined 57.21% | Balanced 60.26% | H-Mean 71.17 | Efficiency 60.26 | Zero 0.000 | LR 1.11e-03 | α 0.0026
Epoch 083/120 [Balanced  ] | Retain 54.47%(23.2) | Forget 0.00%(16.7) | New 67.08%(11.6) | Combined 56.95% | Balanced 60.78% | H-Mean 70.53 | Efficiency 60.78 | Zero 0.000 | LR 1.10e-03 | α 0.0026
Epoch 084/120 [Balanced  ] | Retain 55.90%(24.3) | Forget 0.00%(17.9) | New 66.18%(13.0) | Combined 57.92% | Balanced 61.04% | H-Mean 71.71 | Efficiency 61.04 | Zero 0.000 | LR 1.10e-03 | α 0.0026
Epoch 085/120 [Balanced  ] | Retain 55.90%(24.5) | Forget 0.00%(19.0) | New 67.86%(12.2) | Combined 58.25% | Balanced 61.88% | H-Mean 71.71 | Efficiency 61.88 | Zero 0.000 | LR 1.09e-03 | α 0.0026
Epoch 086/120 [Balanced  ] | Retain 53.65%(23.5) | Forget 0.00%(17.4) | New 66.74%(12.6) | Combined 56.22% | Balanced 60.20% | H-Mean 69.84 | Efficiency 60.20 | Zero 0.000 | LR 1.08e-03 | α 0.0026
Epoch 087/120 [Balanced  ] | Retain 54.88%(24.0) | Forget 0.00%(18.4) | New 66.85%(12.4) | Combined 57.23% | Balanced 60.87% | H-Mean 70.87 | Efficiency 60.87 | Zero 0.000 | LR 1.07e-03 | α 0.0026
Epoch 088/120 [Balanced  ] | Retain 55.43%(24.1) | Forget 0.00%(16.8) | New 65.06%(12.5) | Combined 57.32% | Balanced 60.25% | H-Mean 71.33 | Efficiency 60.25 | Zero 0.000 | LR 1.06e-03 | α 0.0026
Epoch 089/120 [Balanced  ] | Retain 54.47%(23.4) | Forget 0.00%(16.7) | New 69.99%(11.7) | Combined 57.52% | Balanced 62.23% | H-Mean 70.53 | Efficiency 62.23 | Zero 0.000 | LR 1.06e-03 | α 0.0027
Epoch 090/120 [Balanced  ] | Retain 54.06%(22.9) | Forget 0.00%(17.3) | New 67.19%(11.3) | Combined 56.64% | Balanced 60.63% | H-Mean 70.18 | Efficiency 60.63 | Zero 0.000 | LR 4.50e-04 | α 0.0027

🔧 Transitioning to Fine-tuning Phase (optimizing efficiency)
Epoch 091/120 [Fine-tuning] | Retain 55.84%(24.1) | Forget 0.00%(17.9) | New 68.53%(13.0) | Combined 58.33% | Balanced 62.19% | H-Mean 71.66 | Efficiency 62.19 | Zero 0.000 | LR 4.50e-04 | α 0.0027
Epoch 092/120 [Fine-tuning] | Retain 56.50%(24.3) | Forget 0.00%(18.3) | New 69.32%(13.2) | Combined 59.01% | Balanced 62.91% | H-Mean 72.20 | Efficiency 62.91 | Zero 0.000 | LR 4.50e-04 | α 0.0027
  ✓ Saved new best model: Combined Acc 59.01%
    Path: checkpoints/steps/best_step4_epoch92.pth
Epoch 093/120 [Fine-tuning] | Retain 56.72%(24.9) | Forget 0.00%(18.9) | New 69.32%(13.0) | Combined 59.19% | Balanced 63.02% | H-Mean 72.38 | Efficiency 63.02 | Zero 0.000 | LR 4.50e-04 | α 0.0027
Epoch 094/120 [Fine-tuning] | Retain 55.70%(24.3) | Forget 0.00%(18.6) | New 69.32%(13.1) | Combined 58.38% | Balanced 62.51% | H-Mean 71.55 | Efficiency 62.51 | Zero 0.000 | LR 4.50e-04 | α 0.0027
Epoch 095/120 [Fine-tuning] | Retain 54.04%(23.0) | Forget 0.00%(17.3) | New 69.65%(12.3) | Combined 57.10% | Balanced 61.84% | H-Mean 70.16 | Efficiency 61.84 | Zero 0.000 | LR 4.50e-04 | α 0.0027
Epoch 096/120 [Fine-tuning] | Retain 55.81%(23.8) | Forget 0.00%(18.0) | New 71.56%(12.9) | Combined 58.91% | Balanced 63.69% | H-Mean 71.64 | Efficiency 63.69 | Zero 0.000 | LR 4.50e-04 | α 0.0027
Epoch 097/120 [Fine-tuning] | Retain 55.92%(24.0) | Forget 0.00%(18.2) | New 70.66%(13.3) | Combined 58.82% | Balanced 63.29% | H-Mean 71.73 | Efficiency 63.29 | Zero 0.000 | LR 4.50e-04 | α 0.0027
Epoch 098/120 [Fine-tuning] | Retain 55.76%(24.2) | Forget 0.00%(17.7) | New 70.77%(13.0) | Combined 58.71% | Balanced 63.27% | H-Mean 71.60 | Efficiency 63.27 | Zero 0.000 | LR 4.50e-04 | α 0.0027
Epoch 099/120 [Fine-tuning] | Retain 55.95%(24.7) | Forget 0.00%(18.7) | New 70.55%(13.4) | Combined 58.82% | Balanced 63.25% | H-Mean 71.75 | Efficiency 63.25 | Zero 0.000 | LR 4.50e-04 | α 0.0027
Epoch 100/120 [Fine-tuning] | Retain 54.83%(23.9) | Forget 0.00%(18.1) | New 71.11%(12.8) | Combined 58.03% | Balanced 62.97% | H-Mean 70.83 | Efficiency 62.97 | Zero 0.000 | LR 4.50e-04 | α 0.0027
Epoch 101/120 [Fine-tuning] | Retain 56.01%(24.6) | Forget 0.00%(18.1) | New 70.77%(13.5) | Combined 58.91% | Balanced 63.39% | H-Mean 71.80 | Efficiency 63.39 | Zero 0.000 | LR 4.50e-04 | α 0.0027
Epoch 102/120 [Fine-tuning] | Retain 56.47%(25.2) | Forget 0.00%(18.7) | New 70.10%(13.7) | Combined 59.15% | Balanced 63.29% | H-Mean 72.18 | Efficiency 63.29 | Zero 0.000 | LR 4.50e-04 | α 0.0028
Epoch 103/120 [Fine-tuning] | Retain 56.03%(24.8) | Forget 0.00%(18.3) | New 70.88%(13.4) | Combined 58.95% | Balanced 63.46% | H-Mean 71.82 | Efficiency 63.46 | Zero 0.000 | LR 4.50e-04 | α 0.0028
Epoch 104/120 [Fine-tuning] | Retain 55.70%(24.1) | Forget 0.00%(18.6) | New 72.79%(13.1) | Combined 59.06% | Balanced 64.25% | H-Mean 71.55 | Efficiency 64.25 | Zero 0.000 | LR 4.50e-04 | α 0.0028
Epoch 105/120 [Fine-tuning] | Retain 55.54%(24.5) | Forget 0.00%(18.9) | New 70.55%(13.6) | Combined 58.49% | Balanced 63.04% | H-Mean 71.42 | Efficiency 63.04 | Zero 0.000 | LR 4.50e-04 | α 0.0028
Epoch 106/120 [Fine-tuning] | Retain 56.39%(24.9) | Forget 0.00%(19.1) | New 71.78%(13.4) | Combined 59.41% | Balanced 64.08% | H-Mean 72.11 | Efficiency 64.08 | Zero 0.000 | LR 4.50e-04 | α 0.0028
Epoch 107/120 [Fine-tuning] | Retain 56.39%(25.3) | Forget 0.00%(18.8) | New 69.54%(14.4) | Combined 58.97% | Balanced 62.96% | H-Mean 72.11 | Efficiency 62.96 | Zero 0.000 | LR 4.50e-04 | α 0.0028
Epoch 108/120 [Fine-tuning] | Retain 56.17%(24.8) | Forget 0.00%(19.2) | New 71.44%(13.7) | Combined 59.17% | Balanced 63.81% | H-Mean 71.93 | Efficiency 63.81 | Zero 0.000 | LR 4.50e-04 | α 0.0028
Epoch 109/120 [Fine-tuning] | Retain 55.60%(24.6) | Forget 0.00%(19.1) | New 71.67%(14.0) | Combined 58.75% | Balanced 63.63% | H-Mean 71.46 | Efficiency 63.63 | Zero 0.000 | LR 4.50e-04 | α 0.0028
Epoch 110/120 [Fine-tuning] | Retain 56.28%(24.6) | Forget 0.00%(19.4) | New 70.55%(14.0) | Combined 59.08% | Balanced 63.41% | H-Mean 72.02 | Efficiency 63.41 | Zero 0.000 | LR 4.50e-04 | α 0.0028
Epoch 111/120 [Fine-tuning] | Retain 55.60%(24.0) | Forget 0.00%(19.6) | New 71.11%(13.5) | Combined 58.64% | Balanced 63.35% | H-Mean 71.46 | Efficiency 63.35 | Zero 0.000 | LR 4.50e-04 | α 0.0028
Epoch 112/120 [Fine-tuning] | Retain 55.54%(24.4) | Forget 0.00%(20.7) | New 70.66%(14.4) | Combined 58.51% | Balanced 63.10% | H-Mean 71.42 | Efficiency 63.10 | Zero 0.000 | LR 4.50e-04 | α 0.0028
Epoch 113/120 [Fine-tuning] | Retain 55.87%(24.7) | Forget 0.00%(20.6) | New 70.88%(14.2) | Combined 58.82% | Balanced 63.38% | H-Mean 71.69 | Efficiency 63.38 | Zero 0.000 | LR 4.50e-04 | α 0.0028
Epoch 114/120 [Fine-tuning] | Retain 55.29%(24.5) | Forget 0.00%(20.1) | New 72.34%(13.9) | Combined 58.64% | Balanced 63.82% | H-Mean 71.21 | Efficiency 63.82 | Zero 0.000 | LR 4.50e-04 | α 0.0028
Epoch 115/120 [Fine-tuning] | Retain 54.45%(24.1) | Forget 0.00%(19.5) | New 72.12%(13.8) | Combined 57.92% | Balanced 63.28% | H-Mean 70.50 | Efficiency 63.28 | Zero 0.000 | LR 4.50e-04 | α 0.0028
Epoch 116/120 [Fine-tuning] | Retain 55.43%(24.3) | Forget 0.00%(20.3) | New 71.44%(14.3) | Combined 58.58% | Balanced 63.44% | H-Mean 71.33 | Efficiency 63.44 | Zero 0.000 | LR 4.50e-04 | α 0.0028
Epoch 117/120 [Fine-tuning] | Retain 54.69%(24.3) | Forget 0.00%(21.1) | New 71.00%(14.1) | Combined 57.89% | Balanced 62.84% | H-Mean 70.71 | Efficiency 62.84 | Zero 0.000 | LR 4.50e-04 | α 0.0028
Epoch 118/120 [Fine-tuning] | Retain 54.91%(24.3) | Forget 0.00%(23.0) | New 72.68%(14.2) | Combined 58.40% | Balanced 63.79% | H-Mean 70.89 | Efficiency 63.79 | Zero 0.000 | LR 4.50e-04 | α 0.0028
Epoch 119/120 [Fine-tuning] | Retain 56.20%(25.3) | Forget 0.00%(26.3) | New 71.22%(14.6) | Combined 59.15% | Balanced 63.71% | H-Mean 71.96 | Efficiency 63.71 | Zero 0.000 | LR 4.50e-04 | α 0.0028
Epoch 120/120 [Fine-tuning] | Retain 54.17%(24.4) | Forget 0.00%(32.5) | New 71.44%(14.4) | Combined 57.56% | Balanced 62.81% | H-Mean 70.28 | Efficiency 62.81 | Zero 0.000 | LR 4.50e-04 | α 0.0029

================================================================================
ENHANCED GS-LoRA STEP 4 COMPLETE
================================================================================
📊 Final Comprehensive Evaluation:
   Retain Classes (40-79):
     Accuracy: 54.17%
     F1-Score: 49.42%
     Confidence: 30.1%
   Forget Classes (30-39):
     Accuracy: 0.00% (lower is better)
     F1-Score: 0.00%
     Confidence: 36.1%
   New Classes (80-89):
     Accuracy: 71.44%
     F1-Score: 17.67%
     Confidence: 18.1%
   Combined Performance:
     Overall Accuracy: 57.56%
     Balanced Accuracy: 62.81%
   Model Efficiency:
     Zero Group Ratio: 0.000 (0.0% sparse)
     Efficiency Score: 62.81
   Training History: checkpoints/steps/training_history_step4.json
   Best Performance Achieved:
     Epoch: 92
     Combined Accuracy: 59.01%
     Balanced Accuracy: 62.91%
     Best Zero Ratio: 0.000
   Final Model: checkpoints/steps/40_89.pth
================================================================================
⚠️  Retain accuracy 54.17% below threshold 60.00%
⚠️  Combined accuracy 57.56% below threshold 60.00%
⚠️  Sparsity 0.000 below threshold 0.100
❌ Some success criteria not met, but training completed

⏱️  Training Time: 01:59:58

❌ Enhanced GS-LoRA Step 4 completed with issues!
📁 Model still saved to: checkpoints/steps/40_89.pth
💡 Consider adjusting hyperparameters or training for more epochs

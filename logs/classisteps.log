=== Configurations ===
Config: TaskName set to 'classification'
🛠️ Explicitly received params: {'num_classes': 100, 'lora_rank': 8}
🔒 LoRA mode (rank=8): Freezing backbone, unfreezing LoRA + classifier
Loaded pretrained weights from timm: deit_tiny_patch16_224
✅ Loaded pretrained weights
✅ Built classification model

📊 Parameter Summary:
  🔢 Total Parameters     : 5.73M
  ✅ Trainable Parameters : 0.20M
  📉 % Trainable          : 3.55%
🎯 Starting BID-LoRA Sliding Window Experiment
============================================================
🔧 Configuration:
   Alpha (retention weight): 0.15
   Gamma (acquisition weight): 0.15
   BND (erasure limit): 100
============================================================
🔄 Loading model weights from /home/jag/codes/CLU/checkpoints/classification/oracle/0_49.pth...
⚠️ Skipping incompatible or missing keys: ['blocks.0.mlp.fc1.lora_A', 'blocks.0.mlp.fc1.lora_B', 'blocks.0.mlp.fc2.lora_A', 'blocks.0.mlp.fc2.lora_B', 'blocks.1.mlp.fc1.lora_A']... (+43 more)
✅ Loaded pretrained checkpoint: /home/jag/codes/CLU/checkpoints/classification/oracle/0_49.pth

🔥 === STEP 1/5 ===

🔄 Training Step:
  📚 Retain classes: 10-49
  🗑️  Forget classes: 0-9
  ✨ New classes: 50-59

    📈 Epoch 1/50:
      Loss: 15.8465 | LR: 0.000100
      Forget ↓: 78.40% | Retain ↑: 87.57%
      New ↑: 0.00% | Overall ↑: 70.05% ⭐ BEST! Saved: /home/jag/codes/CLU/checkpoints/classification/bid_lora/step1_best.pth

    📈 Epoch 2/50:
      Loss: 15.1255 | LR: 0.000100
      Forget ↓: 0.00% | Retain ↑: 88.00%
      New ↑: 19.47% | Overall ↑: 74.29% ⭐ BEST! Saved: /home/jag/codes/CLU/checkpoints/classification/bid_lora/step1_best.pth

    📈 Epoch 3/50:
      Loss: 1.2432 | LR: 0.000099
      Forget ↓: 0.00% | Retain ↑: 85.33%
      New ↑: 51.20% | Overall ↑: 78.51% ⭐ BEST! Saved: /home/jag/codes/CLU/checkpoints/classification/bid_lora/step1_best.pth

    📈 Epoch 4/50:
      Loss: 0.9137 | LR: 0.000098
      Forget ↓: 0.00% | Retain ↑: 84.63%
      New ↑: 57.60% | Overall ↑: 79.23% ⭐ BEST! Saved: /home/jag/codes/CLU/checkpoints/classification/bid_lora/step1_best.pth

    📈 Epoch 5/50:
      Loss: 0.7663 | LR: 0.000098
      Forget ↓: 0.00% | Retain ↑: 83.80%
      New ↑: 61.47% | Overall ↑: 79.33% ⭐ BEST! Saved: /home/jag/codes/CLU/checkpoints/classification/bid_lora/step1_best.pth

    📈 Epoch 6/50:
      Loss: 0.6974 | LR: 0.000096
      Forget ↓: 0.00% | Retain ↑: 83.27%
      New ↑: 64.40% | Overall ↑: 79.49% ⭐ BEST! Saved: /home/jag/codes/CLU/checkpoints/classification/bid_lora/step1_best.pth

    📈 Epoch 7/50:
      Loss: 0.6417 | LR: 0.000095
      Forget ↓: 0.00% | Retain ↑: 83.13%
      New ↑: 66.27% | Overall ↑: 79.76% ⭐ BEST! Saved: /home/jag/codes/CLU/checkpoints/classification/bid_lora/step1_best.pth

    📈 Epoch 8/50:
      Loss: 0.6164 | LR: 0.000094
      Forget ↓: 0.00% | Retain ↑: 82.93%
      New ↑: 68.40% | Overall ↑: 80.03% ⭐ BEST! Saved: /home/jag/codes/CLU/checkpoints/classification/bid_lora/step1_best.pth

    📈 Epoch 9/50:
      Loss: 0.5720 | LR: 0.000092
      Forget ↓: 0.00% | Retain ↑: 82.57%
      New ↑: 70.27% | Overall ↑: 80.11% ⭐ BEST! Saved: /home/jag/codes/CLU/checkpoints/classification/bid_lora/step1_best.pth

    📈 Epoch 10/50:
      Loss: 0.5530 | LR: 0.000090
      Forget ↓: 0.00% | Retain ↑: 82.53%
      New ↑: 70.93% | Overall ↑: 80.21% ⭐ BEST! Saved: /home/jag/codes/CLU/checkpoints/classification/bid_lora/step1_best.pth

    📈 Epoch 11/50:
      Loss: 0.5319 | LR: 0.000089
      Forget ↓: 0.00% | Retain ↑: 82.77%
      New ↑: 71.73% | Overall ↑: 80.56% ⭐ BEST! Saved: /home/jag/codes/CLU/checkpoints/classification/bid_lora/step1_best.pth

    📈 Epoch 12/50:
      Loss: 0.5067 | LR: 0.000086
      Forget ↓: 0.00% | Retain ↑: 82.53%
      New ↑: 72.53% | Overall ↑: 80.53%

    📈 Epoch 13/50:
      Loss: 0.5032 | LR: 0.000084
      Forget ↓: 0.00% | Retain ↑: 82.43%
      New ↑: 73.47% | Overall ↑: 80.64% ⭐ BEST! Saved: /home/jag/codes/CLU/checkpoints/classification/bid_lora/step1_best.pth

    📈 Epoch 14/50:
      Loss: 0.4889 | LR: 0.000082
      Forget ↓: 0.00% | Retain ↑: 82.57%
      New ↑: 73.33% | Overall ↑: 80.72% ⭐ BEST! Saved: /home/jag/codes/CLU/checkpoints/classification/bid_lora/step1_best.pth

    📈 Epoch 15/50:
      Loss: 0.4792 | LR: 0.000079
      Forget ↓: 0.00% | Retain ↑: 82.40%
      New ↑: 73.87% | Overall ↑: 80.69%

    📈 Epoch 16/50:
      Loss: 0.4604 | LR: 0.000077
      Forget ↓: 0.00% | Retain ↑: 82.33%
      New ↑: 74.67% | Overall ↑: 80.80% ⭐ BEST! Saved: /home/jag/codes/CLU/checkpoints/classification/bid_lora/step1_best.pth

    📈 Epoch 17/50:
      Loss: 0.4611 | LR: 0.000074
      Forget ↓: 0.00% | Retain ↑: 82.37%
      New ↑: 75.20% | Overall ↑: 80.93% ⭐ BEST! Saved: /home/jag/codes/CLU/checkpoints/classification/bid_lora/step1_best.pth

    📈 Epoch 18/50:
      Loss: 0.4492 | LR: 0.000071
      Forget ↓: 0.00% | Retain ↑: 82.17%
      New ↑: 75.47% | Overall ↑: 80.83%

    📈 Epoch 19/50:
      Loss: 0.4419 | LR: 0.000068
      Forget ↓: 0.00% | Retain ↑: 82.13%
      New ↑: 75.87% | Overall ↑: 80.88%

    📈 Epoch 20/50:
      Loss: 0.4328 | LR: 0.000065
      Forget ↓: 0.00% | Retain ↑: 82.07%
      New ↑: 75.73% | Overall ↑: 80.80%

    📈 Epoch 21/50:
      Loss: 0.4315 | LR: 0.000062
      Forget ↓: 0.00% | Retain ↑: 82.03%
      New ↑: 75.07% | Overall ↑: 80.64%

    📈 Epoch 22/50:
      Loss: 0.4307 | LR: 0.000059
      Forget ↓: 0.00% | Retain ↑: 81.87%
      New ↑: 75.73% | Overall ↑: 80.64%

    📈 Epoch 23/50:
      Loss: 0.4214 | LR: 0.000056
      Forget ↓: 0.00% | Retain ↑: 81.70%
      New ↑: 76.67% | Overall ↑: 80.69%

    📈 Epoch 24/50:
      Loss: 0.4165 | LR: 0.000053
      Forget ↓: 0.00% | Retain ↑: 81.80%
      New ↑: 76.53% | Overall ↑: 80.75%

    📈 Epoch 25/50:
      Loss: 0.4179 | LR: 0.000050
      Forget ↓: 0.00% | Retain ↑: 81.57%
      New ↑: 76.93% | Overall ↑: 80.64%

    📈 Epoch 26/50:
      Loss: 0.4139 | LR: 0.000047
      Forget ↓: 0.00% | Retain ↑: 81.67%
      New ↑: 76.13% | Overall ↑: 80.56%

    📈 Epoch 27/50:
      Loss: 0.4068 | LR: 0.000044
      Forget ↓: 0.00% | Retain ↑: 81.67%
      New ↑: 76.53% | Overall ↑: 80.64%

    📈 Epoch 28/50:
      Loss: 0.4073 | LR: 0.000041
      Forget ↓: 0.00% | Retain ↑: 81.67%
      New ↑: 76.40% | Overall ↑: 80.61%

    📈 Epoch 29/50:
      Loss: 0.4111 | LR: 0.000038
      Forget ↓: 0.00% | Retain ↑: 81.63%
      New ↑: 77.07% | Overall ↑: 80.72%

    📈 Epoch 30/50:
      Loss: 0.3994 | LR: 0.000035
      Forget ↓: 0.00% | Retain ↑: 81.60%
      New ↑: 76.93% | Overall ↑: 80.67%

    📈 Epoch 31/50:
      Loss: 0.3903 | LR: 0.000032
      Forget ↓: 0.00% | Retain ↑: 81.63%
      New ↑: 77.07% | Overall ↑: 80.72%

    📈 Epoch 32/50:
      Loss: 0.3916 | LR: 0.000029
      Forget ↓: 0.00% | Retain ↑: 81.57%
      New ↑: 76.93% | Overall ↑: 80.64%

    📈 Epoch 33/50:
      Loss: 0.3932 | LR: 0.000026
      Forget ↓: 0.00% | Retain ↑: 81.53%
      New ↑: 77.07% | Overall ↑: 80.64%

    📈 Epoch 34/50:
      Loss: 0.3867 | LR: 0.000023
      Forget ↓: 0.00% | Retain ↑: 81.53%
      New ↑: 77.33% | Overall ↑: 80.69%

    📈 Epoch 35/50:
      Loss: 0.3909 | LR: 0.000021
      Forget ↓: 0.00% | Retain ↑: 81.53%
      New ↑: 76.67% | Overall ↑: 80.56%

    📈 Epoch 36/50:
      Loss: 0.3955 | LR: 0.000018
      Forget ↓: 0.00% | Retain ↑: 81.50%
      New ↑: 76.67% | Overall ↑: 80.53%

    📈 Epoch 37/50:
      Loss: 0.3818 | LR: 0.000016
      Forget ↓: 0.00% | Retain ↑: 81.50%
      New ↑: 76.80% | Overall ↑: 80.56%

    📈 Epoch 38/50:
      Loss: 0.3829 | LR: 0.000014
      Forget ↓: 0.00% | Retain ↑: 81.47%
      New ↑: 77.20% | Overall ↑: 80.61%

    📈 Epoch 39/50:
      Loss: 0.3836 | LR: 0.000011
      Forget ↓: 0.00% | Retain ↑: 81.40%
      New ↑: 76.93% | Overall ↑: 80.51%

    📈 Epoch 40/50:
      Loss: 0.3911 | LR: 0.000010
      Forget ↓: 0.00% | Retain ↑: 81.40%
      New ↑: 77.07% | Overall ↑: 80.53%

    📈 Epoch 41/50:
      Loss: 0.3960 | LR: 0.000008
      Forget ↓: 0.00% | Retain ↑: 81.40%
      New ↑: 77.07% | Overall ↑: 80.53%

    📈 Epoch 42/50:
      Loss: 0.3928 | LR: 0.000006
      Forget ↓: 0.00% | Retain ↑: 81.37%
      New ↑: 77.07% | Overall ↑: 80.51%

    📈 Epoch 43/50:
      Loss: 0.3872 | LR: 0.000005
      Forget ↓: 0.00% | Retain ↑: 81.37%
      New ↑: 77.07% | Overall ↑: 80.51%

    📈 Epoch 44/50:
      Loss: 0.3858 | LR: 0.000004
      Forget ↓: 0.00% | Retain ↑: 81.37%
      New ↑: 76.93% | Overall ↑: 80.48%

    📈 Epoch 45/50:
      Loss: 0.3808 | LR: 0.000002
      Forget ↓: 0.00% | Retain ↑: 81.37%
      New ↑: 77.07% | Overall ↑: 80.51%

    📈 Epoch 46/50:
      Loss: 0.4013 | LR: 0.000002
      Forget ↓: 0.00% | Retain ↑: 81.40%
      New ↑: 77.07% | Overall ↑: 80.53%

    📈 Epoch 47/50:
      Loss: 0.3858 | LR: 0.000001
      Forget ↓: 0.00% | Retain ↑: 81.37%
      New ↑: 77.07% | Overall ↑: 80.51%

    📈 Epoch 48/50:
      Loss: 0.3852 | LR: 0.000000
      Forget ↓: 0.00% | Retain ↑: 81.37%
      New ↑: 77.07% | Overall ↑: 80.51%

    📈 Epoch 49/50:
      Loss: 0.3813 | LR: 0.000000
      Forget ↓: 0.00% | Retain ↑: 81.37%
      New ↑: 76.93% | Overall ↑: 80.48%

    📈 Epoch 50/50:
      Loss: 0.3803 | LR: 0.000000
      Forget ↓: 0.00% | Retain ↑: 81.37%
      New ↑: 76.93% | Overall ↑: 80.48%

✅ Training completed! Best Overall: 80.93%

📊 VALIDATION RESULTS:
============================================================
  Forget ↓ (0-9): 0.00% (0/750)
  Retain ↑ (10-49): 81.37% (2441/3000)
  New ↑ (50-59): 76.93% (577/750)
  Overall ↑ (10-59): 80.48% (3018/3750)
============================================================

📋 STEP 1 FINAL SUMMARY:
  🗑️  Forget ↓: 0.00% (Classes 0-9)
  📚 Retain ↑: 81.37% (Classes 10-49)
  ✨ New ↑: 76.93% (Classes 50-59)
  🎯 Overall ↑: 80.48%
💾 Saved checkpoint: /home/jag/codes/CLU/checkpoints/classification/bid_lora/step1.pth

🔥 === STEP 2/5 ===

🔄 Training Step:
  📚 Retain classes: 20-59
  🗑️  Forget classes: 0-19
  ✨ New classes: 60-69

    📈 Epoch 1/50:
      Loss: 3.2546 | LR: 0.000100
      Forget ↓: 36.13% | Retain ↑: 76.47%
      New ↑: 44.13% | Overall ↑: 70.00% ⭐ BEST! Saved: /home/jag/codes/CLU/checkpoints/classification/bid_lora/step2_best.pth

    📈 Epoch 2/50:
      Loss: 14.7185 | LR: 0.000100
      Forget ↓: 17.93% | Retain ↑: 78.80%
      New ↑: 44.53% | Overall ↑: 71.95% ⭐ BEST! Saved: /home/jag/codes/CLU/checkpoints/classification/bid_lora/step2_best.pth

    📈 Epoch 3/50:
      Loss: 13.6789 | LR: 0.000099
      Forget ↓: 0.00% | Retain ↑: 78.47%
      New ↑: 44.53% | Overall ↑: 71.68%

    📈 Epoch 4/50:
      Loss: 1.0688 | LR: 0.000098
      Forget ↓: 0.00% | Retain ↑: 74.70%
      New ↑: 61.20% | Overall ↑: 72.00% ⭐ BEST! Saved: /home/jag/codes/CLU/checkpoints/classification/bid_lora/step2_best.pth

    📈 Epoch 5/50:
      Loss: 0.9266 | LR: 0.000098
      Forget ↓: 0.00% | Retain ↑: 74.43%
      New ↑: 65.07% | Overall ↑: 72.56% ⭐ BEST! Saved: /home/jag/codes/CLU/checkpoints/classification/bid_lora/step2_best.pth

    📈 Epoch 6/50:
      Loss: 0.8505 | LR: 0.000096
      Forget ↓: 0.00% | Retain ↑: 74.50%
      New ↑: 67.60% | Overall ↑: 73.12% ⭐ BEST! Saved: /home/jag/codes/CLU/checkpoints/classification/bid_lora/step2_best.pth

    📈 Epoch 7/50:
      Loss: 0.8044 | LR: 0.000095
      Forget ↓: 0.00% | Retain ↑: 74.57%
      New ↑: 69.60% | Overall ↑: 73.57% ⭐ BEST! Saved: /home/jag/codes/CLU/checkpoints/classification/bid_lora/step2_best.pth

    📈 Epoch 8/50:
      Loss: 0.7662 | LR: 0.000094
      Forget ↓: 0.00% | Retain ↑: 74.73%
      New ↑: 70.80% | Overall ↑: 73.95% ⭐ BEST! Saved: /home/jag/codes/CLU/checkpoints/classification/bid_lora/step2_best.pth

    📈 Epoch 9/50:
      Loss: 0.7449 | LR: 0.000092
      Forget ↓: 0.00% | Retain ↑: 74.50%
      New ↑: 71.07% | Overall ↑: 73.81%

    📈 Epoch 10/50:
      Loss: 0.7104 | LR: 0.000090
      Forget ↓: 0.00% | Retain ↑: 74.70%
      New ↑: 71.87% | Overall ↑: 74.13% ⭐ BEST! Saved: /home/jag/codes/CLU/checkpoints/classification/bid_lora/step2_best.pth

    📈 Epoch 11/50:
      Loss: 0.6869 | LR: 0.000089
      Forget ↓: 0.00% | Retain ↑: 74.77%
      New ↑: 72.53% | Overall ↑: 74.32% ⭐ BEST! Saved: /home/jag/codes/CLU/checkpoints/classification/bid_lora/step2_best.pth

    📈 Epoch 12/50:
      Loss: 0.6703 | LR: 0.000086
      Forget ↓: 0.00% | Retain ↑: 74.70%
      New ↑: 72.80% | Overall ↑: 74.32%

    📈 Epoch 13/50:
      Loss: 0.6522 | LR: 0.000084
      Forget ↓: 0.00% | Retain ↑: 74.93%
      New ↑: 73.60% | Overall ↑: 74.67% ⭐ BEST! Saved: /home/jag/codes/CLU/checkpoints/classification/bid_lora/step2_best.pth

    📈 Epoch 14/50:
      Loss: 0.6312 | LR: 0.000082
      Forget ↓: 0.00% | Retain ↑: 74.97%
      New ↑: 73.20% | Overall ↑: 74.61%

    📈 Epoch 15/50:
      Loss: 0.6200 | LR: 0.000079
      Forget ↓: 0.00% | Retain ↑: 74.77%
      New ↑: 73.33% | Overall ↑: 74.48%

    📈 Epoch 16/50:
      Loss: 0.6263 | LR: 0.000077
      Forget ↓: 0.00% | Retain ↑: 74.83%
      New ↑: 73.60% | Overall ↑: 74.59%

    📈 Epoch 17/50:
      Loss: 0.5973 | LR: 0.000074
      Forget ↓: 0.00% | Retain ↑: 74.80%
      New ↑: 74.40% | Overall ↑: 74.72% ⭐ BEST! Saved: /home/jag/codes/CLU/checkpoints/classification/bid_lora/step2_best.pth

    📈 Epoch 18/50:
      Loss: 0.5921 | LR: 0.000071
      Forget ↓: 0.00% | Retain ↑: 74.73%
      New ↑: 74.40% | Overall ↑: 74.67%

    📈 Epoch 19/50:
      Loss: 0.5925 | LR: 0.000068
      Forget ↓: 0.00% | Retain ↑: 74.83%
      New ↑: 74.80% | Overall ↑: 74.83% ⭐ BEST! Saved: /home/jag/codes/CLU/checkpoints/classification/bid_lora/step2_best.pth

    📈 Epoch 20/50:
      Loss: 0.5695 | LR: 0.000065
      Forget ↓: 0.00% | Retain ↑: 74.60%
      New ↑: 74.80% | Overall ↑: 74.64%

    📈 Epoch 21/50:
      Loss: 0.5668 | LR: 0.000062
      Forget ↓: 0.00% | Retain ↑: 74.63%
      New ↑: 74.93% | Overall ↑: 74.69%

    📈 Epoch 22/50:
      Loss: 0.5629 | LR: 0.000059
      Forget ↓: 0.00% | Retain ↑: 74.67%
      New ↑: 75.47% | Overall ↑: 74.83%

    📈 Epoch 23/50:
      Loss: 0.5598 | LR: 0.000056
      Forget ↓: 0.00% | Retain ↑: 74.77%
      New ↑: 75.20% | Overall ↑: 74.85% ⭐ BEST! Saved: /home/jag/codes/CLU/checkpoints/classification/bid_lora/step2_best.pth

    📈 Epoch 24/50:
      Loss: 0.5456 | LR: 0.000053
      Forget ↓: 0.00% | Retain ↑: 74.67%
      New ↑: 75.07% | Overall ↑: 74.75%

    📈 Epoch 25/50:
      Loss: 0.5448 | LR: 0.000050
      Forget ↓: 0.00% | Retain ↑: 74.73%
      New ↑: 75.47% | Overall ↑: 74.88% ⭐ BEST! Saved: /home/jag/codes/CLU/checkpoints/classification/bid_lora/step2_best.pth

    📈 Epoch 26/50:
      Loss: 0.5358 | LR: 0.000047
      Forget ↓: 0.00% | Retain ↑: 74.67%
      New ↑: 75.73% | Overall ↑: 74.88%

    📈 Epoch 27/50:
      Loss: 0.5324 | LR: 0.000044
      Forget ↓: 0.00% | Retain ↑: 74.47%
      New ↑: 76.13% | Overall ↑: 74.80%

    📈 Epoch 28/50:
      Loss: 0.5306 | LR: 0.000041
      Forget ↓: 0.00% | Retain ↑: 74.53%
      New ↑: 75.73% | Overall ↑: 74.77%

    📈 Epoch 29/50:
      Loss: 0.5221 | LR: 0.000038
      Forget ↓: 0.00% | Retain ↑: 74.53%
      New ↑: 75.87% | Overall ↑: 74.80%

    📈 Epoch 30/50:
      Loss: 0.5239 | LR: 0.000035
      Forget ↓: 0.00% | Retain ↑: 74.20%
      New ↑: 76.13% | Overall ↑: 74.59%

    📈 Epoch 31/50:
      Loss: 0.5160 | LR: 0.000032
      Forget ↓: 0.00% | Retain ↑: 74.43%
      New ↑: 75.73% | Overall ↑: 74.69%

    📈 Epoch 32/50:
      Loss: 0.5243 | LR: 0.000029
      Forget ↓: 0.00% | Retain ↑: 74.40%
      New ↑: 75.73% | Overall ↑: 74.67%

    📈 Epoch 33/50:
      Loss: 0.5141 | LR: 0.000026
      Forget ↓: 0.00% | Retain ↑: 74.40%
      New ↑: 76.00% | Overall ↑: 74.72%

    📈 Epoch 34/50:
      Loss: 0.5214 | LR: 0.000023
      Forget ↓: 0.00% | Retain ↑: 74.40%
      New ↑: 76.13% | Overall ↑: 74.75%

    📈 Epoch 35/50:
      Loss: 0.5189 | LR: 0.000021
      Forget ↓: 0.00% | Retain ↑: 74.50%
      New ↑: 76.00% | Overall ↑: 74.80%

    📈 Epoch 36/50:
      Loss: 0.5138 | LR: 0.000018
      Forget ↓: 0.00% | Retain ↑: 74.47%
      New ↑: 76.13% | Overall ↑: 74.80%

    📈 Epoch 37/50:
      Loss: 0.5098 | LR: 0.000016
      Forget ↓: 0.00% | Retain ↑: 74.47%
      New ↑: 76.13% | Overall ↑: 74.80%

    📈 Epoch 38/50:
      Loss: 0.5221 | LR: 0.000014
      Forget ↓: 0.00% | Retain ↑: 74.50%
      New ↑: 76.13% | Overall ↑: 74.83%

=== Configurations ===
Config: TaskName set to 'Face_recognition'
🚀 Enhanced GS-LoRA CLU Training - Step 2
============================================================
🔧 Configuration:
   Device: cuda
   LoRA Rank: 16 (Enhanced)
   Base Learning Rate: 0.001
   Training Phases: 30 + 60 + 30 = 120 epochs
   Loss Weights: Retain=2.0, New=2.0, Forget=0.15
   Sparsity Settings: Warmup=10, Alpha_K=0.003
   Learning Rate Multipliers: LoRA=2.0x, Retain=0.5x, New=1.5x
   Step Description: Second step: Retain 20-59, Forget 10-19, Learn 60-69
============================================================

================================================================================
ENHANCED GS-LoRA STEP 2
Retain Classes: 20-59 (40 classes)
Forget Classes: 10-19 (10 classes)
New Classes:    60-69 (10 classes)
LoRA Rank: 16, Epochs: 120
================================================================================
🛠️ Explicitly received params: {'GPU_ID': [0], 'num_class': 100, 'lora_rank': 16}
🔒 LoRA mode (rank=16): Freezing backbone, unfreezing LoRA + classifier
Loaded pretrained weights from timm: deit_tiny_patch16_224
✅ Loaded pretrained weights
✅ Built face model

📊 Parameter Summary:
  🔢 Total Parameters     : 5.79M
  ✅ Trainable Parameters : 0.39M
  📉 % Trainable          : 6.69%
✓ Loaded model from: checkpoints/steps/10_59.pth
  Compatible parameters: 187/187
✓ Found 12 LoRA groups for enhanced sparse regularization
✓ Data loaders created:
  Retain: 67 batches
  Forget: 97 batches
  New:    104 batches
✓ Enhanced optimizer created with 2 parameter groups

🚀 Starting Enhanced Training for 120 epochs
Phase Schedule: Retention(30) -> Balanced(60) -> Fine-tuning(30)
Epoch 001/120 [Retention ] | Retain 61.21%(29.4) | Forget 0.00%(20.5) | New 0.00%(22.9) | Combined 49.63% | Balanced 30.60% | H-Mean 75.94 | Efficiency 30.60 | Zero 0.000 | LR 1.50e-03 | α 0.0000
  ✓ Saved new best model: Combined Acc 49.63%
    Path: checkpoints/steps/best_step2_epoch1.pth
Epoch 002/120 [Retention ] | Retain 64.86%(31.0) | Forget 0.00%(21.2) | New 0.12%(24.0) | Combined 52.61% | Balanced 32.49% | H-Mean 78.68 | Efficiency 32.49 | Zero 0.000 | LR 1.50e-03 | α 0.0000
  ✓ Saved new best model: Combined Acc 52.61%
    Path: checkpoints/steps/best_step2_epoch2.pth
Epoch 003/120 [Retention ] | Retain 65.16%(31.0) | Forget 0.00%(21.2) | New 0.00%(25.0) | Combined 52.84% | Balanced 32.58% | H-Mean 78.91 | Efficiency 32.58 | Zero 0.000 | LR 1.50e-03 | α 0.0000
Epoch 004/120 [Retention ] | Retain 66.08%(32.6) | Forget 0.00%(22.1) | New 0.59%(25.6) | Combined 53.69% | Balanced 33.33% | H-Mean 79.57 | Efficiency 33.33 | Zero 0.000 | LR 1.50e-03 | α 0.0000
  ✓ Saved new best model: Combined Acc 53.69%
    Path: checkpoints/steps/best_step2_epoch4.pth
Epoch 005/120 [Retention ] | Retain 66.57%(32.0) | Forget 0.00%(22.4) | New 0.12%(24.6) | Combined 54.00% | Balanced 33.35% | H-Mean 79.93 | Efficiency 33.35 | Zero 0.000 | LR 1.50e-03 | α 0.0000
Epoch 006/120 [Retention ] | Retain 67.04%(31.1) | Forget 0.00%(21.4) | New 2.14%(22.5) | Combined 54.77% | Balanced 34.59% | H-Mean 80.27 | Efficiency 34.59 | Zero 0.000 | LR 1.50e-03 | α 0.0000
  ✓ Saved new best model: Combined Acc 54.77%
    Path: checkpoints/steps/best_step2_epoch6.pth
Epoch 007/120 [Retention ] | Retain 66.35%(32.4) | Forget 0.00%(22.2) | New 0.47%(24.1) | Combined 53.89% | Balanced 33.41% | H-Mean 79.77 | Efficiency 33.41 | Zero 0.000 | LR 1.50e-03 | α 0.0000
Epoch 008/120 [Retention ] | Retain 66.96%(32.8) | Forget 0.00%(21.1) | New 2.14%(22.7) | Combined 54.70% | Balanced 34.55% | H-Mean 80.21 | Efficiency 34.55 | Zero 0.000 | LR 1.50e-03 | α 0.0000
Epoch 009/120 [Retention ] | Retain 67.04%(30.0) | Forget 0.00%(21.1) | New 2.02%(20.4) | Combined 54.75% | Balanced 34.53% | H-Mean 80.27 | Efficiency 34.53 | Zero 0.000 | LR 1.50e-03 | α 0.0000
Epoch 010/120 [Retention ] | Retain 67.68%(31.4) | Forget 0.00%(20.2) | New 3.91%(20.4) | Combined 55.62% | Balanced 35.80% | H-Mean 80.73 | Efficiency 35.80 | Zero 0.000 | LR 1.50e-03 | α 0.0000
  ✓ Saved new best model: Combined Acc 55.62%
    Path: checkpoints/steps/best_step2_epoch10.pth
Epoch 011/120 [Retention ] | Retain 66.96%(30.0) | Forget 0.00%(19.8) | New 3.91%(19.3) | Combined 55.04% | Balanced 35.44% | H-Mean 80.21 | Efficiency 35.44 | Zero 0.000 | LR 1.50e-03 | α 0.0001
Epoch 012/120 [Retention ] | Retain 67.52%(31.7) | Forget 0.00%(20.6) | New 6.64%(20.3) | Combined 56.00% | Balanced 37.08% | H-Mean 80.61 | Efficiency 37.08 | Zero 0.000 | LR 1.50e-03 | α 0.0002
Epoch 013/120 [Retention ] | Retain 67.60%(31.1) | Forget 0.00%(20.1) | New 7.00%(18.5) | Combined 56.14% | Balanced 37.30% | H-Mean 80.67 | Efficiency 37.30 | Zero 0.000 | LR 1.50e-03 | α 0.0002
  ✓ Saved new best model: Combined Acc 56.14%
    Path: checkpoints/steps/best_step2_epoch13.pth
Epoch 014/120 [Retention ] | Retain 67.21%(30.6) | Forget 0.00%(19.4) | New 7.00%(17.6) | Combined 55.82% | Balanced 37.10% | H-Mean 80.39 | Efficiency 37.10 | Zero 0.000 | LR 1.50e-03 | α 0.0003
Epoch 015/120 [Retention ] | Retain 68.15%(31.2) | Forget 0.00%(19.0) | New 9.73%(16.9) | Combined 57.10% | Balanced 38.94% | H-Mean 81.06 | Efficiency 38.94 | Zero 0.000 | LR 1.50e-03 | α 0.0004
  ✓ Saved new best model: Combined Acc 57.10%
    Path: checkpoints/steps/best_step2_epoch15.pth
Epoch 016/120 [Retention ] | Retain 67.16%(31.6) | Forget 0.00%(20.0) | New 11.03%(17.5) | Combined 56.54% | Balanced 39.09% | H-Mean 80.35 | Efficiency 39.09 | Zero 0.000 | LR 1.50e-03 | α 0.0005
Epoch 017/120 [Retention ] | Retain 66.60%(30.1) | Forget 0.00%(18.2) | New 13.17%(15.5) | Combined 56.50% | Balanced 39.88% | H-Mean 79.95 | Efficiency 39.88 | Zero 0.000 | LR 1.50e-03 | α 0.0005
Epoch 018/120 [Retention ] | Retain 66.33%(31.2) | Forget 0.00%(20.6) | New 14.12%(16.2) | Combined 56.45% | Balanced 40.22% | H-Mean 79.75 | Efficiency 40.22 | Zero 0.000 | LR 1.50e-03 | α 0.0006
Epoch 019/120 [Retention ] | Retain 65.61%(30.2) | Forget 0.00%(19.8) | New 13.88%(15.3) | Combined 55.82% | Balanced 39.74% | H-Mean 79.23 | Efficiency 39.74 | Zero 0.000 | LR 1.50e-03 | α 0.0007
Epoch 020/120 [Retention ] | Retain 66.74%(29.2) | Forget 0.00%(17.2) | New 15.90%(14.0) | Combined 57.12% | Balanced 41.32% | H-Mean 80.05 | Efficiency 41.32 | Zero 0.000 | LR 1.50e-03 | α 0.0007
Epoch 021/120 [Retention ] | Retain 67.63%(30.7) | Forget 0.00%(19.6) | New 16.25%(13.8) | Combined 57.91% | Balanced 41.94% | H-Mean 80.69 | Efficiency 41.94 | Zero 0.000 | LR 1.50e-03 | α 0.0008
  ✓ Saved new best model: Combined Acc 57.91%
    Path: checkpoints/steps/best_step2_epoch21.pth
Epoch 022/120 [Retention ] | Retain 65.86%(27.7) | Forget 0.00%(16.4) | New 20.40%(12.4) | Combined 57.26% | Balanced 43.13% | H-Mean 79.41 | Efficiency 43.13 | Zero 0.000 | LR 1.50e-03 | α 0.0008
Epoch 023/120 [Retention ] | Retain 67.49%(29.5) | Forget 0.00%(19.1) | New 19.34%(13.1) | Combined 58.38% | Balanced 43.41% | H-Mean 80.59 | Efficiency 43.41 | Zero 0.000 | LR 1.50e-03 | α 0.0009
Epoch 024/120 [Retention ] | Retain 66.63%(29.9) | Forget 0.00%(17.8) | New 17.91%(14.0) | Combined 57.42% | Balanced 42.27% | H-Mean 79.97 | Efficiency 42.27 | Zero 0.000 | LR 1.50e-03 | α 0.0010
Epoch 025/120 [Retention ] | Retain 66.41%(30.1) | Forget 0.00%(18.3) | New 20.05%(12.8) | Combined 57.64% | Balanced 43.23% | H-Mean 79.81 | Efficiency 43.23 | Zero 0.000 | LR 1.50e-03 | α 0.0010
Epoch 026/120 [Retention ] | Retain 65.02%(27.8) | Forget 0.00%(17.3) | New 25.15%(10.8) | Combined 57.48% | Balanced 45.09% | H-Mean 78.81 | Efficiency 45.09 | Zero 0.000 | LR 1.50e-03 | α 0.0011
Epoch 027/120 [Retention ] | Retain 66.21%(29.3) | Forget 0.00%(18.5) | New 17.32%(12.7) | Combined 56.97% | Balanced 41.77% | H-Mean 79.67 | Efficiency 41.77 | Zero 0.000 | LR 1.50e-03 | α 0.0011
Epoch 028/120 [Retention ] | Retain 65.44%(29.0) | Forget 0.00%(18.2) | New 23.13%(10.9) | Combined 57.44% | Balanced 44.29% | H-Mean 79.11 | Efficiency 44.29 | Zero 0.000 | LR 1.50e-03 | α 0.0012
Epoch 029/120 [Retention ] | Retain 67.32%(29.9) | Forget 0.00%(17.5) | New 22.89%(11.6) | Combined 58.92% | Balanced 45.11% | H-Mean 80.47 | Efficiency 45.11 | Zero 0.000 | LR 1.50e-03 | α 0.0012
  ✓ Saved new best model: Combined Acc 58.92%
    Path: checkpoints/steps/best_step2_epoch29.pth
Epoch 030/120 [Retention ] | Retain 66.08%(29.4) | Forget 0.00%(18.3) | New 24.67%(10.6) | Combined 58.25% | Balanced 45.38% | H-Mean 79.57 | Efficiency 45.38 | Zero 0.000 | LR 1.50e-03 | α 0.0013

🔄 Transitioning to Balanced Phase (emphasis on both retain and new)
Epoch 031/120 [Balanced  ] | Retain 64.97%(27.3) | Forget 0.00%(16.1) | New 26.45%(9.4) | Combined 57.68% | Balanced 45.71% | H-Mean 78.77 | Efficiency 45.71 | Zero 0.000 | LR 1.49e-03 | α 0.0013
Epoch 032/120 [Balanced  ] | Retain 65.97%(28.5) | Forget 0.00%(15.9) | New 30.96%(9.6) | Combined 59.34% | Balanced 48.46% | H-Mean 79.49 | Efficiency 48.46 | Zero 0.000 | LR 1.48e-03 | α 0.0014
Epoch 033/120 [Balanced  ] | Retain 64.83%(28.4) | Forget 0.00%(16.9) | New 29.66%(9.3) | Combined 58.18% | Balanced 47.24% | H-Mean 78.66 | Efficiency 47.24 | Zero 0.000 | LR 1.48e-03 | α 0.0014
Epoch 034/120 [Balanced  ] | Retain 65.52%(28.3) | Forget 0.00%(16.2) | New 24.91%(9.1) | Combined 57.84% | Balanced 45.22% | H-Mean 79.17 | Efficiency 45.22 | Zero 0.000 | LR 1.47e-03 | α 0.0014
Epoch 035/120 [Balanced  ] | Retain 65.19%(27.1) | Forget 0.00%(16.5) | New 34.99%(8.2) | Combined 59.48% | Balanced 50.09% | H-Mean 78.93 | Efficiency 50.09 | Zero 0.000 | LR 1.46e-03 | α 0.0015
  ✓ Saved new best model: Combined Acc 59.48%
    Path: checkpoints/steps/best_step2_epoch35.pth
Epoch 036/120 [Balanced  ] | Retain 64.47%(27.6) | Forget 0.00%(16.9) | New 33.93%(8.2) | Combined 58.69% | Balanced 49.20% | H-Mean 78.40 | Efficiency 49.20 | Zero 0.000 | LR 1.45e-03 | α 0.0015
Epoch 037/120 [Balanced  ] | Retain 63.48%(27.0) | Forget 0.00%(15.8) | New 34.40%(8.5) | Combined 57.98% | Balanced 48.94% | H-Mean 77.66 | Efficiency 48.94 | Zero 0.000 | LR 1.45e-03 | α 0.0016
Epoch 038/120 [Balanced  ] | Retain 64.08%(28.0) | Forget 0.00%(16.7) | New 35.82%(9.2) | Combined 58.74% | Balanced 49.95% | H-Mean 78.11 | Efficiency 49.95 | Zero 0.000 | LR 1.44e-03 | α 0.0016
Epoch 039/120 [Balanced  ] | Retain 64.53%(27.3) | Forget 0.00%(17.2) | New 33.10%(8.7) | Combined 58.58% | Balanced 48.81% | H-Mean 78.44 | Efficiency 48.81 | Zero 0.000 | LR 1.43e-03 | α 0.0016
Epoch 040/120 [Balanced  ] | Retain 63.97%(27.6) | Forget 0.00%(16.8) | New 33.57%(9.2) | Combined 58.22% | Balanced 48.77% | H-Mean 78.03 | Efficiency 48.77 | Zero 0.000 | LR 1.43e-03 | α 0.0017
Epoch 041/120 [Balanced  ] | Retain 63.78%(26.4) | Forget 0.00%(14.9) | New 39.15%(7.7) | Combined 59.12% | Balanced 51.46% | H-Mean 77.88 | Efficiency 51.46 | Zero 0.000 | LR 1.42e-03 | α 0.0017
Epoch 042/120 [Balanced  ] | Retain 63.97%(27.7) | Forget 0.00%(15.7) | New 36.42%(8.7) | Combined 58.76% | Balanced 50.20% | H-Mean 78.03 | Efficiency 50.20 | Zero 0.000 | LR 1.41e-03 | α 0.0017
Epoch 043/120 [Balanced  ] | Retain 63.72%(26.7) | Forget 0.00%(15.1) | New 40.69%(7.7) | Combined 59.37% | Balanced 52.21% | H-Mean 77.84 | Efficiency 52.21 | Zero 0.000 | LR 1.40e-03 | α 0.0018
Epoch 044/120 [Balanced  ] | Retain 62.29%(26.1) | Forget 0.00%(15.6) | New 40.81%(7.0) | Combined 58.22% | Balanced 51.55% | H-Mean 76.76 | Efficiency 51.55 | Zero 0.000 | LR 1.39e-03 | α 0.0018
Epoch 045/120 [Balanced  ] | Retain 63.20%(26.9) | Forget 0.00%(17.2) | New 36.77%(8.1) | Combined 58.20% | Balanced 49.99% | H-Mean 77.45 | Efficiency 49.99 | Zero 0.000 | LR 1.39e-03 | α 0.0018
Epoch 046/120 [Balanced  ] | Retain 63.42%(26.5) | Forget 0.00%(16.2) | New 45.20%(7.0) | Combined 59.97% | Balanced 54.31% | H-Mean 77.62 | Efficiency 54.31 | Zero 0.000 | LR 1.38e-03 | α 0.0019
Epoch 047/120 [Balanced  ] | Retain 62.45%(26.4) | Forget 0.00%(16.3) | New 45.55%(6.9) | Combined 59.26% | Balanced 54.00% | H-Mean 76.89 | Efficiency 54.00 | Zero 0.000 | LR 1.37e-03 | α 0.0019
Epoch 048/120 [Balanced  ] | Retain 62.87%(26.4) | Forget 0.00%(15.4) | New 44.25%(7.0) | Combined 59.34% | Balanced 53.56% | H-Mean 77.20 | Efficiency 53.56 | Zero 0.000 | LR 1.36e-03 | α 0.0019
Epoch 049/120 [Balanced  ] | Retain 61.65%(25.6) | Forget 0.00%(15.7) | New 43.89%(6.8) | Combined 58.29% | Balanced 52.77% | H-Mean 76.28 | Efficiency 52.77 | Zero 0.000 | LR 1.36e-03 | α 0.0020
Epoch 050/120 [Balanced  ] | Retain 62.59%(26.4) | Forget 0.00%(15.6) | New 39.74%(7.9) | Combined 58.27% | Balanced 51.16% | H-Mean 76.99 | Efficiency 51.16 | Zero 0.000 | LR 1.35e-03 | α 0.0020
Epoch 051/120 [Balanced  ] | Retain 62.37%(25.8) | Forget 0.00%(14.9) | New 45.31%(6.7) | Combined 59.14% | Balanced 53.84% | H-Mean 76.82 | Efficiency 53.84 | Zero 0.000 | LR 1.34e-03 | α 0.0020
Epoch 052/120 [Balanced  ] | Retain 61.32%(26.7) | Forget 0.00%(14.8) | New 43.77%(7.4) | Combined 58.00% | Balanced 52.54% | H-Mean 76.02 | Efficiency 52.54 | Zero 0.000 | LR 1.34e-03 | α 0.0020
Epoch 053/120 [Balanced  ] | Retain 61.07%(25.4) | Forget 0.00%(15.1) | New 47.21%(7.1) | Combined 58.45% | Balanced 54.14% | H-Mean 75.83 | Efficiency 54.14 | Zero 0.000 | LR 1.33e-03 | α 0.0021
Epoch 054/120 [Balanced  ] | Retain 60.74%(24.7) | Forget 0.00%(15.8) | New 46.03%(6.8) | Combined 57.95% | Balanced 53.38% | H-Mean 75.57 | Efficiency 53.38 | Zero 0.000 | LR 1.32e-03 | α 0.0021
Epoch 055/120 [Balanced  ] | Retain 62.06%(25.7) | Forget 0.00%(16.6) | New 47.69%(7.6) | Combined 59.34% | Balanced 54.88% | H-Mean 76.59 | Efficiency 54.88 | Zero 0.000 | LR 1.31e-03 | α 0.0021
Epoch 056/120 [Balanced  ] | Retain 60.90%(24.7) | Forget 0.00%(15.7) | New 46.38%(7.1) | Combined 58.16% | Balanced 53.64% | H-Mean 75.70 | Efficiency 53.64 | Zero 0.000 | LR 1.30e-03 | α 0.0021
Epoch 057/120 [Balanced  ] | Retain 61.10%(25.7) | Forget 0.00%(15.1) | New 50.06%(7.3) | Combined 59.01% | Balanced 55.58% | H-Mean 75.85 | Efficiency 55.58 | Zero 0.000 | LR 1.30e-03 | α 0.0022
Epoch 058/120 [Balanced  ] | Retain 61.32%(25.4) | Forget 0.00%(15.5) | New 51.72%(7.0) | Combined 59.50% | Balanced 56.52% | H-Mean 76.02 | Efficiency 56.52 | Zero 0.000 | LR 1.29e-03 | α 0.0022
Epoch 059/120 [Balanced  ] | Retain 60.38%(24.9) | Forget 0.00%(15.3) | New 54.21%(6.7) | Combined 59.21% | Balanced 57.29% | H-Mean 75.29 | Efficiency 57.29 | Zero 0.000 | LR 1.28e-03 | α 0.0022
Epoch 060/120 [Balanced  ] | Retain 60.24%(24.9) | Forget 0.00%(15.1) | New 54.09%(6.8) | Combined 59.08% | Balanced 57.17% | H-Mean 75.19 | Efficiency 57.17 | Zero 0.000 | LR 1.27e-03 | α 0.0022
Epoch 061/120 [Balanced  ] | Retain 61.01%(25.3) | Forget 0.00%(15.9) | New 53.14%(7.1) | Combined 59.52% | Balanced 57.08% | H-Mean 75.79 | Efficiency 57.08 | Zero 0.000 | LR 1.27e-03 | α 0.0023
Epoch 062/120 [Balanced  ] | Retain 61.76%(25.7) | Forget 0.00%(15.7) | New 51.72%(7.6) | Combined 59.86% | Balanced 56.74% | H-Mean 76.36 | Efficiency 56.74 | Zero 0.000 | LR 1.26e-03 | α 0.0023
Epoch 063/120 [Balanced  ] | Retain 60.90%(24.7) | Forget 0.00%(15.4) | New 55.87%(7.1) | Combined 59.95% | Balanced 58.39% | H-Mean 75.70 | Efficiency 58.39 | Zero 0.000 | LR 1.25e-03 | α 0.0023
Epoch 064/120 [Balanced  ] | Retain 60.79%(25.3) | Forget 0.00%(15.8) | New 52.79%(7.6) | Combined 59.28% | Balanced 56.79% | H-Mean 75.62 | Efficiency 56.79 | Zero 0.000 | LR 1.25e-03 | α 0.0023
Epoch 065/120 [Balanced  ] | Retain 58.49%(23.8) | Forget 0.00%(14.7) | New 55.16%(6.9) | Combined 57.86% | Balanced 56.83% | H-Mean 73.81 | Efficiency 56.83 | Zero 0.000 | LR 1.24e-03 | α 0.0023
Epoch 066/120 [Balanced  ] | Retain 61.59%(25.5) | Forget 0.00%(16.7) | New 56.23%(7.2) | Combined 60.58% | Balanced 58.91% | H-Mean 76.23 | Efficiency 58.91 | Zero 0.000 | LR 1.23e-03 | α 0.0023
  ✓ Saved new best model: Combined Acc 60.58%
    Path: checkpoints/steps/best_step2_epoch66.pth
Epoch 067/120 [Balanced  ] | Retain 60.04%(24.1) | Forget 0.00%(14.3) | New 57.53%(6.7) | Combined 59.57% | Balanced 58.79% | H-Mean 75.03 | Efficiency 58.79 | Zero 0.000 | LR 1.22e-03 | α 0.0024
Epoch 068/120 [Balanced  ] | Retain 60.49%(24.3) | Forget 0.00%(15.0) | New 56.58%(7.2) | Combined 59.75% | Balanced 58.54% | H-Mean 75.38 | Efficiency 58.54 | Zero 0.000 | LR 1.22e-03 | α 0.0024
Epoch 069/120 [Balanced  ] | Retain 58.99%(24.2) | Forget 0.00%(15.9) | New 58.96%(7.2) | Combined 58.99% | Balanced 58.97% | H-Mean 74.21 | Efficiency 58.97 | Zero 0.000 | LR 1.21e-03 | α 0.0024
Epoch 070/120 [Balanced  ] | Retain 60.07%(24.7) | Forget 0.00%(16.4) | New 55.99%(7.9) | Combined 59.30% | Balanced 58.03% | H-Mean 75.06 | Efficiency 58.03 | Zero 0.000 | LR 1.20e-03 | α 0.0024
Epoch 071/120 [Balanced  ] | Retain 59.77%(24.3) | Forget 0.00%(15.3) | New 58.60%(6.9) | Combined 59.55% | Balanced 59.18% | H-Mean 74.82 | Efficiency 59.18 | Zero 0.000 | LR 1.19e-03 | α 0.0024
Epoch 072/120 [Balanced  ] | Retain 59.91%(24.4) | Forget 0.00%(15.4) | New 60.14%(6.9) | Combined 59.95% | Balanced 60.02% | H-Mean 74.93 | Efficiency 60.02 | Zero 0.000 | LR 1.19e-03 | α 0.0024
Epoch 073/120 [Balanced  ] | Retain 60.38%(24.8) | Forget 0.00%(16.4) | New 58.84%(7.5) | Combined 60.09% | Balanced 59.61% | H-Mean 75.29 | Efficiency 59.61 | Zero 0.000 | LR 1.18e-03 | α 0.0025
Epoch 074/120 [Balanced  ] | Retain 58.85%(25.4) | Forget 0.00%(17.1) | New 57.30%(8.6) | Combined 58.56% | Balanced 58.07% | H-Mean 74.10 | Efficiency 58.07 | Zero 0.000 | LR 1.17e-03 | α 0.0025
Epoch 075/120 [Balanced  ] | Retain 60.99%(25.5) | Forget 0.00%(16.1) | New 56.47%(8.1) | Combined 60.13% | Balanced 58.73% | H-Mean 75.76 | Efficiency 58.73 | Zero 0.000 | LR 1.16e-03 | α 0.0025
Epoch 076/120 [Balanced  ] | Retain 59.96%(24.6) | Forget 0.00%(16.1) | New 58.60%(8.2) | Combined 59.70% | Balanced 59.28% | H-Mean 74.97 | Efficiency 59.28 | Zero 0.000 | LR 1.16e-03 | α 0.0025
Epoch 077/120 [Balanced  ] | Retain 60.85%(25.0) | Forget 0.00%(15.6) | New 59.91%(7.9) | Combined 60.67% | Balanced 60.38% | H-Mean 75.66 | Efficiency 60.38 | Zero 0.000 | LR 1.15e-03 | α 0.0025
Epoch 078/120 [Balanced  ] | Retain 57.72%(23.8) | Forget 0.00%(15.1) | New 60.26%(8.2) | Combined 58.20% | Balanced 58.99% | H-Mean 73.19 | Efficiency 58.99 | Zero 0.000 | LR 1.14e-03 | α 0.0025
Epoch 079/120 [Balanced  ] | Retain 58.30%(23.8) | Forget 0.00%(15.9) | New 60.85%(8.1) | Combined 58.78% | Balanced 59.58% | H-Mean 73.66 | Efficiency 59.58 | Zero 0.000 | LR 1.13e-03 | α 0.0025
Epoch 080/120 [Balanced  ] | Retain 58.27%(23.7) | Forget 0.00%(15.5) | New 62.16%(7.6) | Combined 59.01% | Balanced 60.22% | H-Mean 73.64 | Efficiency 60.22 | Zero 0.000 | LR 1.13e-03 | α 0.0026
Epoch 081/120 [Balanced  ] | Retain 56.42%(22.6) | Forget 0.00%(14.1) | New 63.23%(7.6) | Combined 57.71% | Balanced 59.82% | H-Mean 72.14 | Efficiency 59.82 | Zero 0.000 | LR 1.12e-03 | α 0.0026
Epoch 082/120 [Balanced  ] | Retain 59.08%(24.2) | Forget 0.00%(15.5) | New 62.51%(8.2) | Combined 59.73% | Balanced 60.80% | H-Mean 74.27 | Efficiency 60.80 | Zero 0.000 | LR 1.11e-03 | α 0.0026
Epoch 083/120 [Balanced  ] | Retain 56.23%(22.2) | Forget 0.00%(14.9) | New 65.95%(7.6) | Combined 58.07% | Balanced 61.09% | H-Mean 71.98 | Efficiency 61.09 | Zero 0.000 | LR 1.10e-03 | α 0.0026
Epoch 084/120 [Balanced  ] | Retain 59.19%(24.7) | Forget 0.00%(16.3) | New 62.28%(8.5) | Combined 59.77% | Balanced 60.73% | H-Mean 74.36 | Efficiency 60.73 | Zero 0.000 | LR 1.10e-03 | α 0.0026
Epoch 085/120 [Balanced  ] | Retain 60.18%(24.7) | Forget 0.00%(16.2) | New 64.77%(7.9) | Combined 61.05% | Balanced 62.48% | H-Mean 75.14 | Efficiency 62.48 | Zero 0.000 | LR 1.09e-03 | α 0.0026
Epoch 086/120 [Balanced  ] | Retain 55.06%(23.0) | Forget 0.00%(15.4) | New 60.14%(8.4) | Combined 56.02% | Balanced 57.60% | H-Mean 71.02 | Efficiency 57.60 | Zero 0.000 | LR 1.08e-03 | α 0.0026
Epoch 087/120 [Balanced  ] | Retain 59.46%(24.3) | Forget 0.00%(17.5) | New 62.75%(8.8) | Combined 60.09% | Balanced 61.11% | H-Mean 74.58 | Efficiency 61.11 | Zero 0.000 | LR 1.07e-03 | α 0.0026
Epoch 088/120 [Balanced  ] | Retain 56.89%(23.4) | Forget 0.00%(16.4) | New 63.70%(8.0) | Combined 58.18% | Balanced 60.30% | H-Mean 72.52 | Efficiency 60.30 | Zero 0.000 | LR 1.06e-03 | α 0.0026
Epoch 089/120 [Balanced  ] | Retain 58.69%(24.4) | Forget 0.00%(15.8) | New 66.19%(8.7) | Combined 60.11% | Balanced 62.44% | H-Mean 73.97 | Efficiency 62.44 | Zero 0.000 | LR 1.06e-03 | α 0.0027
Epoch 090/120 [Balanced  ] | Retain 57.36%(23.5) | Forget 0.00%(16.7) | New 66.43%(8.8) | Combined 59.08% | Balanced 61.89% | H-Mean 72.90 | Efficiency 61.89 | Zero 0.000 | LR 4.50e-04 | α 0.0027

🔧 Transitioning to Fine-tuning Phase (optimizing efficiency)
Epoch 091/120 [Fine-tuning] | Retain 59.80%(24.4) | Forget 0.00%(16.6) | New 68.09%(8.7) | Combined 61.36% | Balanced 63.94% | H-Mean 74.84 | Efficiency 63.94 | Zero 0.000 | LR 4.50e-04 | α 0.0027
  ✓ Saved new best model: Combined Acc 61.36%
    Path: checkpoints/steps/best_step2_epoch91.pth
Epoch 092/120 [Fine-tuning] | Retain 60.07%(24.7) | Forget 0.00%(16.4) | New 66.43%(9.0) | Combined 61.27% | Balanced 63.25% | H-Mean 75.06 | Efficiency 63.25 | Zero 0.000 | LR 4.50e-04 | α 0.0027
Epoch 093/120 [Fine-tuning] | Retain 58.94%(24.2) | Forget 0.00%(16.7) | New 66.19%(9.1) | Combined 60.31% | Balanced 62.56% | H-Mean 74.16 | Efficiency 62.56 | Zero 0.000 | LR 4.50e-04 | α 0.0027
Epoch 094/120 [Fine-tuning] | Retain 60.49%(25.4) | Forget 0.00%(17.6) | New 66.07%(9.3) | Combined 61.54% | Balanced 63.28% | H-Mean 75.38 | Efficiency 63.28 | Zero 0.000 | LR 4.50e-04 | α 0.0027
Epoch 095/120 [Fine-tuning] | Retain 59.08%(24.3) | Forget 0.00%(17.0) | New 66.07%(9.2) | Combined 60.40% | Balanced 62.57% | H-Mean 74.27 | Efficiency 62.57 | Zero 0.000 | LR 4.50e-04 | α 0.0027
Epoch 096/120 [Fine-tuning] | Retain 58.47%(23.9) | Forget 0.00%(17.2) | New 69.04%(8.9) | Combined 60.47% | Balanced 63.75% | H-Mean 73.79 | Efficiency 63.75 | Zero 0.000 | LR 4.50e-04 | α 0.0027
Epoch 097/120 [Fine-tuning] | Retain 58.74%(24.1) | Forget 0.00%(17.7) | New 67.97%(9.0) | Combined 60.49% | Balanced 63.36% | H-Mean 74.01 | Efficiency 63.36 | Zero 0.000 | LR 4.50e-04 | α 0.0027
Epoch 098/120 [Fine-tuning] | Retain 58.38%(24.2) | Forget 0.00%(18.2) | New 68.45%(9.4) | Combined 60.29% | Balanced 63.42% | H-Mean 73.72 | Efficiency 63.42 | Zero 0.000 | LR 4.50e-04 | α 0.0027
Epoch 099/120 [Fine-tuning] | Retain 59.10%(25.3) | Forget 0.00%(20.5) | New 69.28%(9.1) | Combined 61.03% | Balanced 64.19% | H-Mean 74.30 | Efficiency 64.19 | Zero 0.000 | LR 4.50e-04 | α 0.0027
Epoch 100/120 [Fine-tuning] | Retain 60.21%(25.9) | Forget 0.00%(23.3) | New 67.73%(9.4) | Combined 61.63% | Balanced 63.97% | H-Mean 75.16 | Efficiency 63.97 | Zero 0.000 | LR 4.50e-04 | α 0.0027
Epoch 101/120 [Fine-tuning] | Retain 59.32%(26.3) | Forget 0.00%(32.4) | New 67.50%(9.7) | Combined 60.87% | Balanced 63.41% | H-Mean 74.47 | Efficiency 63.41 | Zero 0.000 | LR 4.50e-04 | α 0.0027
Epoch 102/120 [Fine-tuning] | Retain 58.36%(25.3) | Forget 0.00%(38.6) | New 69.28%(9.3) | Combined 60.42% | Balanced 63.82% | H-Mean 73.70 | Efficiency 63.82 | Zero 0.000 | LR 4.50e-04 | α 0.0028
Epoch 103/120 [Fine-tuning] | Retain 58.11%(25.3) | Forget 0.00%(40.0) | New 68.45%(9.8) | Combined 60.06% | Balanced 63.28% | H-Mean 73.50 | Efficiency 63.28 | Zero 0.000 | LR 4.50e-04 | α 0.0028
Epoch 104/120 [Fine-tuning] | Retain 58.52%(26.5) | Forget 0.00%(47.5) | New 68.80%(9.8) | Combined 60.47% | Balanced 63.66% | H-Mean 73.83 | Efficiency 63.66 | Zero 0.000 | LR 4.50e-04 | α 0.0028
Epoch 105/120 [Fine-tuning] | Retain 59.10%(27.2) | Forget 0.00%(48.3) | New 67.14%(10.2) | Combined 60.62% | Balanced 63.12% | H-Mean 74.30 | Efficiency 63.12 | Zero 0.000 | LR 4.50e-04 | α 0.0028
Epoch 106/120 [Fine-tuning] | Retain 58.94%(25.3) | Forget 0.00%(44.8) | New 68.45%(9.7) | Combined 60.74% | Balanced 63.69% | H-Mean 74.16 | Efficiency 63.69 | Zero 0.000 | LR 4.50e-04 | α 0.0028
Epoch 107/120 [Fine-tuning] | Retain 57.89%(26.7) | Forget 0.00%(48.1) | New 67.62%(10.1) | Combined 59.73% | Balanced 62.75% | H-Mean 73.33 | Efficiency 62.75 | Zero 0.000 | LR 4.50e-04 | α 0.0028
Epoch 108/120 [Fine-tuning] | Retain 58.47%(27.3) | Forget 0.00%(51.5) | New 68.33%(10.6) | Combined 60.33% | Balanced 63.40% | H-Mean 73.79 | Efficiency 63.40 | Zero 0.000 | LR 4.50e-04 | α 0.0028
Epoch 109/120 [Fine-tuning] | Retain 57.78%(26.7) | Forget 0.00%(49.9) | New 67.73%(10.2) | Combined 59.66% | Balanced 62.75% | H-Mean 73.24 | Efficiency 62.75 | Zero 0.000 | LR 4.50e-04 | α 0.0028
Epoch 110/120 [Fine-tuning] | Retain 56.86%(26.3) | Forget 0.00%(51.8) | New 67.97%(9.8) | Combined 58.96% | Balanced 62.42% | H-Mean 72.50 | Efficiency 62.42 | Zero 0.000 | LR 4.50e-04 | α 0.0028
Epoch 111/120 [Fine-tuning] | Retain 59.16%(28.3) | Forget 0.00%(53.3) | New 68.09%(10.6) | Combined 60.85% | Balanced 63.62% | H-Mean 74.34 | Efficiency 63.62 | Zero 0.000 | LR 4.50e-04 | α 0.0028
Epoch 112/120 [Fine-tuning] | Retain 58.27%(28.8) | Forget 0.00%(55.2) | New 67.02%(11.1) | Combined 59.93% | Balanced 62.65% | H-Mean 73.64 | Efficiency 62.65 | Zero 0.000 | LR 4.50e-04 | α 0.0028
Epoch 113/120 [Fine-tuning] | Retain 57.50%(28.9) | Forget 0.00%(55.1) | New 68.21%(11.2) | Combined 59.52% | Balanced 62.85% | H-Mean 73.01 | Efficiency 62.85 | Zero 0.000 | LR 4.50e-04 | α 0.0028
Epoch 114/120 [Fine-tuning] | Retain 57.69%(27.0) | Forget 0.00%(53.0) | New 69.40%(10.0) | Combined 59.91% | Balanced 63.54% | H-Mean 73.17 | Efficiency 63.54 | Zero 0.000 | LR 4.50e-04 | α 0.0028
Epoch 115/120 [Fine-tuning] | Retain 56.89%(27.0) | Forget 0.00%(53.6) | New 70.23%(10.3) | Combined 59.41% | Balanced 63.56% | H-Mean 72.52 | Efficiency 63.56 | Zero 0.000 | LR 4.50e-04 | α 0.0028
Epoch 116/120 [Fine-tuning] | Retain 57.17%(28.0) | Forget 0.00%(55.6) | New 67.85%(10.5) | Combined 59.19% | Balanced 62.51% | H-Mean 72.75 | Efficiency 62.51 | Zero 0.000 | LR 4.50e-04 | α 0.0028

⏰ Early stopping triggered at epoch 116
   Best balanced accuracy: 63.94%

================================================================================
ENHANCED GS-LoRA STEP 2 COMPLETE
================================================================================
📊 Final Comprehensive Evaluation:
   Retain Classes (20-59):
     Accuracy: 59.80%
     F1-Score: 53.76%
     Confidence: 29.9%
   Forget Classes (10-19):
     Accuracy: 0.00% (lower is better)
     F1-Score: 0.00%
     Confidence: 20.2%
   New Classes (60-69):
     Accuracy: 68.09%
     F1-Score: 19.88%
     Confidence: 10.7%
   Combined Performance:
     Overall Accuracy: 61.36%
     Balanced Accuracy: 63.94%
   Model Efficiency:
     Zero Group Ratio: 0.000 (0.0% sparse)
     Efficiency Score: 63.94
   Training History: checkpoints/steps/training_history_step2.json
   Best Performance Achieved:
     Epoch: 91
     Combined Accuracy: 61.36%
     Balanced Accuracy: 63.94%
     Best Zero Ratio: 0.000
   Final Model: checkpoints/steps/20_69.pth
================================================================================
⚠️  Retain accuracy 59.80% below threshold 60.00%
⚠️  Sparsity 0.000 below threshold 0.100
❌ Some success criteria not met, but training completed

⏱️  Training Time: 01:51:22

❌ Enhanced GS-LoRA Step 2 completed with issues!
📁 Model still saved to: checkpoints/steps/20_69.pth
💡 Consider adjusting hyperparameters or training for more epochs

=== Configurations ===
Config: TaskName set to 'face_recognition'
ğŸ› ï¸ Explicitly received params: {'GPU_ID': [0], 'num_class': 100, 'lora_rank': 8}
ğŸ”’ LoRA mode (rank=8): Freezing backbone, unfreezing LoRA + classifier
Loaded pretrained weights from timm: deit_tiny_patch16_224
âœ… Loaded pretrained weights
âœ… Built face model

ğŸ“Š Parameter Summary:
  ğŸ”¢ Total Parameters     : 5.61M
  âœ… Trainable Parameters : 0.20M
  ğŸ“‰ % Trainable          : 3.63%
ğŸ¯ Starting BID-LoRA Face Recognition Sliding Window Experiment
============================================================
ğŸ”§ Configuration:
   Alpha (retention weight): 0.15
   Gamma (acquisition weight): 1
   BND (erasure limit): 100
============================================================
ğŸ”„ Loading model weights from /home/jag/codes/CLU/checkpoints/face/oracle/0_49.pth...
âš ï¸ Skipping incompatible or missing keys: ['transformer.layers.0.1.fn.fn.net.0.lora_A', 'transformer.layers.0.1.fn.fn.net.0.lora_B', 'transformer.layers.0.1.fn.fn.net.3.lora_A', 'transformer.layers.0.1.fn.fn.net.3.lora_B', 'transformer.layers.1.1.fn.fn.net.0.lora_A']... (+43 more)
âœ… Loaded pretrained checkpoint: /home/jag/codes/CLU/checkpoints/face/oracle/0_49.pth

ğŸ”¥ === STEP 1/5 ===

ğŸ”„ Training Step:
  ğŸ“š Retain classes: 10-49
  ğŸ—‘ï¸ Forget classes: 0-9
  âœ¨ New classes: 50-59
âœ… Imprinted weights for classes 50-59 (initialized from centroids)
âš¡ Head warmup on NEW classes for 5 epochs (margin ON, head_lr=0.0005)
    Warmup 1: acquisition loss 14.7554
    Warmup 2: acquisition loss 11.6479
    Warmup 3: acquisition loss 10.7655
    Warmup 4: acquisition loss 10.5324
    Warmup 5: acquisition loss 10.4285

    ğŸ“ˆ Epoch 1/50:
      Loss: 145.7098 | LR_head: 0.000100
      Forget â†“: 0.00% | Retain â†‘: 0.00%
      New â†‘: 52.97% | Overall â†‘: 10.55% â­ BEST! Saved: /home/jag/codes/CLU/checkpoints/face/bid_lora/step1_best.pth

    ğŸ“ˆ Epoch 2/50:
      Loss: 93.8636 | LR_head: 0.000100
      Forget â†“: 0.00% | Retain â†‘: 0.00%
      New â†‘: 53.65% | Overall â†‘: 10.69% â­ BEST! Saved: /home/jag/codes/CLU/checkpoints/face/bid_lora/step1_best.pth
